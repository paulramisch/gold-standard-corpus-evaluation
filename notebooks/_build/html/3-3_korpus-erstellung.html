
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3.3 Erstellung des Goldstandard-Korpus &#8212; Goldstandard-Korpus-Evaluation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/book.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="3.4 Matching der Redebeiträge" href="3-4_matching.html" />
    <link rel="prev" title="3 Methode: Goldstandard-Korpus-Evaluation" href="3_methode.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="de">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Goldstandard-Korpus-Evaluation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
<a class="reference internal" href="0_start.html">Goldstandard-Korpus-Evaluation/a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="1_einleitung.html">
   1 Einleitung
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
    <li class="toctree-l2">
        <a class="reference internal" href="1_einleitung.html#digitale-quellenkritik-im-kontext-der-bundestagsprotokolle">1.1 Digitale Quellenkritik im Kontext der Bundestagsprotokolle</a>
    </li>
    <li class="toctree-l2">
        <a class="reference internal" href="1_einleitung.html#goldstandard-korpus-evaluation-als-methode-der-digital-history">1.2 Goldstandard-Korpus-Evaluation als Methode der Digital History</a>
    </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2_daten.html">
   2 Quellengrundlage &amp; Daten: Bundestagsprotokolle &amp; Open Discourse
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
    <li class="toctree-l2">
      <a class="reference internal" href="2_daten.html#plenarprotokolle-des-bundestags-als-open-data">2.1 Plenarprotokolle des Bundestags als Open Data</a>
    </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2-2_open-discourse.html">
     2.2	Open Discourse
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="3_methode.html">
   3 Methode: Goldstandard-Korpus-Evaluation
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
    <li class="toctree-l2">
        <a class="reference internal" href="3_methode.html#untersuchungskriterien">3.1 Untersuchungskriterien</a>
    </li>
    <li class="toctree-l2">
        <a class="reference internal" href="3_methode.html#stichprobe">3.2 Stichprobe</a>
    </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-3_korpus-erstellung.html">
     3.3 Erstellung des Goldstandard-Korpus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-4_matching.html">
     3.4 Matching der Redebeiträge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-5_analyse.html">
     3.5 Datenanalyse
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-6_fazit.html">
     3.6 Fazit
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_epistemologische-konsequenzen.html">
   4	Epistemologische Konsequenzen für die Geschichtswissenschaften
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Schluss.html">
   5 Schluss
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_quellen-und-daten.html">
   Quellen- &amp; Datenverzeichnis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_literatur.html">
   Literaturverzeichnis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/3-3_korpus-erstellung.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/3-3_korpus-erstellung.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metadatenextraktion-dokumentengliederung">
   3.3.1 Metadatenextraktion &amp; Dokumentengliederung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tagging-der-redebeitrage">
   3.3.2 Tagging der Redebeiträge
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extraktion-matching-redner-innen">
   3.3.3 Extraktion &amp; Matching Redner:innen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erstellung-abgeordneten-tabelle">
     3.3.3.1 Erstellung Abgeordneten-Tabelle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erstellung-id-tabelle-aller-abgeordneter-regierungsmitglieder-bundesratsmitglieder">
     3.3.3.2 Erstellung ID-Tabelle aller Abgeordneter, Regierungsmitglieder &amp; Bundesratsmitglieder
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-matching-und-anreicherung-der-xml-dateien">
     3.3.3.3 Rede-Matching und Anreicherung der XML-Dateien
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>3.3 Erstellung des Goldstandard-Korpus</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metadatenextraktion-dokumentengliederung">
   3.3.1 Metadatenextraktion &amp; Dokumentengliederung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tagging-der-redebeitrage">
   3.3.2 Tagging der Redebeiträge
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extraktion-matching-redner-innen">
   3.3.3 Extraktion &amp; Matching Redner:innen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erstellung-abgeordneten-tabelle">
     3.3.3.1 Erstellung Abgeordneten-Tabelle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erstellung-id-tabelle-aller-abgeordneter-regierungsmitglieder-bundesratsmitglieder">
     3.3.3.2 Erstellung ID-Tabelle aller Abgeordneter, Regierungsmitglieder &amp; Bundesratsmitglieder
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-matching-und-anreicherung-der-xml-dateien">
     3.3.3.3 Rede-Matching und Anreicherung der XML-Dateien
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="erstellung-des-goldstandard-korpus">
<h1>3.3 Erstellung des Goldstandard-Korpus<a class="headerlink" href="#erstellung-des-goldstandard-korpus" title="Link zu dieser Überschrift">#</a></h1>
<p>In dem Annotationsprozess wurden alle Redebeiträge in den XML-Protokollen annotiert und mit einer Redner:innen-ID versehen. Als Datengrundlage dienten dabei die XML-Rohdaten des Bundestags, sie ist also identisch mit den Daten, mit denen das OP-Korpus erstellt wurde. Der Prozess gliedert sich in fünf Schritte:</p>
<ol class="simple">
<li><p>Extraktion der Sitzungsmetadaten (automatisiert)</p></li>
<li><p>Einteilung in Inhaltsverzeichnis, Sitzungsverlauf und Anhang (teilautomatisiert)</p></li>
<li><p>Tagging der Redebeiträge, ausgenommen Zwischenrufe (manuell)</p></li>
<li><p>Extraktion und Matching der Redner*innen (teilautomatisiert)</p></li>
<li><p>Vergleich des OP- und Goldstandard-Korpus (teilautomatisiert)</p></li>
</ol>
<p>Für alle Redebeiträge wurde analog zum OP-Korpus der Vor- und Nachname, die Funktion und Fraktion des:der Sprecher:in extrahiert sowie (sofern vorhanden) mit der Stammdaten-ID gematched. Dies geschah in einem überwachten, automatisierten Prozess. In einer Reihe von Fällen mussten die Redebeiträge manuell zugeordnet werden, wenn die Zuordnung nicht eindeutig war. In diesem Kontext wurden den Redner:innen Informationen wie Parteizugehörigkeit und Funktionsgruppe sowie spezielle Identifikatoren - QIDs und GND-IDs - zugeordnet. QIDs sind eindeutige Identifikatoren von Wikipedias Wikidata, während GND-IDs von der Gemeinsamen Normdatei stammen, einem Normdaten-Standard in Bibliotheken. Beide Kennungen fungieren hier als eindeutige Bezeichner für Personen und erleichtern präzise Datenverknüpfungen über das Korpus hinaus.</p>
<p>Dabei wurde keine Inter-Annotator-Bewertung durchgeführt, es haben also nicht mehrere Personen das Korpus unabhängig voneinander annotiert und deren Ergebnisse dann verglichen, sondern es fand eine Annotation statt die zweimal vollständig überprüft wurde.<a class="reference external" href="#ref_1">[1]</a> Die Ambiguität der Annotation („Ist das Fragment ein Redebeitrag?“) war in diesem Fall quasi nicht vorhanden, da eine klare Struktur vorliegt.</p>
<section id="metadatenextraktion-dokumentengliederung">
<h2>3.3.1 Metadatenextraktion &amp; Dokumentengliederung<a class="headerlink" href="#metadatenextraktion-dokumentengliederung" title="Link zu dieser Überschrift">#</a></h2>
<p>Die Protokolle wurden im ersten Schritt mit den Meta-Daten zu Ort, Datum, Beginn- und Enduhrzeit versehen und mit XML-Tags in Inhaltsverzeichnis, Hauptteil und Schluss gegliedert, beides angelehnt an das DTP-XML-Format des Bundestags ab der 19. Periode. Bei dem Protokoll <a class="reference external" href="https://dserver.bundestag.de/btp/01/01020.pdf">01020</a>, das im XML auch den Text des Folgeprotokolls beinhaltet, wurde dieser entsprechend gelöscht.</p>
</section>
<section id="tagging-der-redebeitrage">
<h2>3.3.2 Tagging der Redebeiträge<a class="headerlink" href="#tagging-der-redebeitrage" title="Link zu dieser Überschrift">#</a></h2>
<p>Im Hauptteil wurde jeder Redebeitrag in ein XML-Tag „verpackt“. Insbesondere Redebeiträge durch die (Vize-)Präsident:innen können dabei mehrere Tagesordnungspunkte überspannen. Dies ist abweichend von den modernen XML-Dokumenten der 19. und 20. Periode. Diese ordnen die Redebeiträge nach Tagesordnungspunkten, dagegen entspricht die hier genutzte Variante der OP-Modellierung und ähnelt den gedruckten Dokumenten, da diese ebenfalls keinen neuen Redebeitrag einleiten (dies geschähe jeweils mit der Nennung der Redner:in). Der Hauptteil sieht dann beispielhaft folgendermaßen aus (<a class="reference external" href="https://dserver.bundestag.de/btp/03/03018.pdf">03018</a>):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sitzungsverlauf&gt;</span>Deutscher Bundestag — 3. Wahlperiode — 18. Sitzung. Bonn, Donnerstag, den 20. März 1958	823
18. Sitzung
Bonn, den 20. März 1958
Stenographischer Bericht
Beginn: 9.03 Uhr.
<span class="nt">&lt;red&gt;</span>
Präsident D. Dr. Gerstenmaier: Die Sitzung ist eröffnet.
Vor Eintritt in die Tagesordnung darf ich unserer Kollegin Frau Dr. h. c. Weber die Glückwünsche des Hauses aussprechen. Zum wievielten Geburtstag, sage ich nicht.
(Heiterkeit und Beifall.)
[...]
<span class="nt">&lt;/red&gt;</span>
<span class="nt">&lt;red&gt;</span>
Dr. Gradl (CDU/CSU) : Herr Präsident! Meine Damen und Herren! Die Fraktion der Christlich-Demokratischen und Christlich-Sozialen Union hat am 27. Februar eine Große Anfrage an die Bundesregierung gerichtet. [...]
<span class="nt">&lt;/red&gt;</span>
[...]
<span class="nt">&lt;/sitzungsverlauf&gt;</span>
</pre></div>
</div>
<p>Bei der Annotation stand die Abgrenzung der Redebeiträge im Vordergrund. Absätze nach dem öffnenden und schließenden <code class="docutils literal notranslate"><span class="pre">&lt;red&gt;</span></code>-Tag wurden dabei entfernt, da diese für die weitere Verarbeitung keine Relevanz hatten. Kopfzeilen wurden nicht entfernt oder getaggt und Zwischenrufe nicht ausgezeichnet.</p>
<p>Die 36 ausgewählten Dokumente wurden händisch annotiert, dann ein zweites Mal manuell vollständig durchgearbeitet und im dritten Schritt nochmals mithilfe einer Plausibilitätsprüfung der extrahierten Metadaten des:der Sprecher:in überprüft. Zuletzt wurde ein Machine-Learning-Modell für die Überprüfung eingesetzt.</p>
<p>Die Annotation wurde in Visual Studio Code durchgeführt, dabei wurde mit der Suchfunktion das RegEx-Muster <code class="docutils literal notranslate"><span class="pre">^(?![\(—]).{5,100}:</span></code> gesucht, um es als Markierung zu nutzen.</p>
<p><img alt="Annotationsprozess in Visual Studio Code" src="_images/annotation_process_vsc.png" />
<em>Abbildung 2: Darstellung der Nutzung eines RegEx-Musters für die Hervorhebung möglicher Redebeitrags-Anfänge im Annotationsprozess in Visual Studio Code.</em></p>
<p>Der Beginn einer Rede ist fest vorgegeben, grundsätzlich steht in der ersten Zeile der Name und ggf. die Position der Person gefolgt von einem Doppelpunkt. Dies wird durch den zweiten Teil des RegEx-Musters repräsentiert: <code class="docutils literal notranslate"><span class="pre">.{5,100}:</span></code>, dies findet Zeichenketten mit der Länge 5 - 100 die ein Doppelpunkt abschließt. Der erste Teil des Suchmusters, <code class="docutils literal notranslate"><span class="pre">^(?![\(—])</span></code>, findet nur Zeichenketten, die an einem Zeilenanfang anfangen. Es entstehen jedoch keine Matches, wenn die Zeile mit einer Klammer oder einem Bindestrich beginnt, beides Zeichen, die einen Zwischenruf einleiten. Diese RegEx-Regel führt auch zu Matches, die eigentlich keine neuen Redebeiträge darstellen, sondern beispielsweise Zitate innerhalb einer Rede oder schlicht Sätze mit Doppelpunkten sind. Dies wird im Annotations-Prozess validiert, der Vorteil ist, dass viele Spezialfälle nicht fälschlich durch ein zu enges Muster verloren gehen. In Kombination mit dem konstanten Abgleich mit dem Inhaltsverzeichnis können so sehr effizient die Redebeiträge annotiert werden:</p>
<p>Die 36 Dokumente enthalten damit 7532 manuell getaggte Redebeiträge, also durchschnittlich 209 Redebeiträge je Protokoll. Dies betrifft nicht nur Reden, sondern auch alle Zwischenfragen und Moderationsbeiträge; nicht inkludiert sind Zwischenrufe.</p>
</section>
<section id="extraktion-matching-redner-innen">
<h2>3.3.3 Extraktion &amp; Matching Redner:innen<a class="headerlink" href="#extraktion-matching-redner-innen" title="Link zu dieser Überschrift">#</a></h2>
<p>Für alle Redebeiträge wird in diesem Kapitel, analog zu den OP-Daten, der Vor- und Nachname, die Funktion und Fraktion extrahiert und die Redner:innen mit ihrer ID aus den Bundestags-Stammdaten gematcht. Als zusätzliche Identifier werden noch die QIDs und GND-IDs den Redner:innen zugeführt. Erstere bietet den Vorteil, dass für alle Redner:innen, also auch Vertreter:innen der Bundesregierung und des Bundesrats, die nicht selbst Abgeordnete des Bundestags sind, ein eindeutiger Identifier vorliegt; dies ist in den OP-Daten nicht gegeben. Daneben sind als Zusatzinformationen auch die Funktionsgruppe (Abgeordnete, Sitzungsvorstand, Bundesregierung, Bundesrat) und die Partei angegeben. Hier das Ziel als beispielhafter XML-Ausschnitt aus <a class="reference external" href="https://dserver.bundestag.de/btp/01/01020.pdf">01020</a>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;red</span> <span class="na">first_name=</span><span class="s">&quot;Erich&quot;</span> <span class="na">last_name=</span><span class="s">&quot;Köhler&quot;</span> <span class="na">group=</span><span class="s">&quot;&quot;</span> <span class="na">party=</span><span class="s">&quot;CDU&quot;</span> <span class="na">position=</span><span class="s">&quot;Präsident&quot;</span> <span class="na">position_group=</span><span class="s">&quot;Sitzungsvorstand&quot;</span> <span class="na">id=</span><span class="s">&quot;11001150&quot;</span> <span class="na">GND=</span><span class="s">&quot;129496901&quot;</span> <span class="na">QID=</span><span class="s">&quot;Q70058&quot;</span><span class="nt">&gt;</span>
Präsident Dr. Köhler: Das Wort hat der Herr Abgeordnete Dr. Lehr.
<span class="nt">&lt;/red&gt;</span>
<span class="nt">&lt;red</span> <span class="na">first_name=</span><span class="s">&quot;Robert&quot;</span> <span class="na">last_name=</span><span class="s">&quot;Lehr&quot;</span> <span class="na">group=</span><span class="s">&quot;CDU/CSU&quot;</span> <span class="na">party=</span><span class="s">&quot;CDU&quot;</span> <span class="na">position=</span><span class="s">&quot;Abgeordnete:r&quot;</span> <span class="na">position_group=</span><span class="s">&quot;Abgeordnete:r&quot;</span> <span class="na">id=</span><span class="s">&quot;11001304&quot;</span> <span class="na">GND=</span><span class="s">&quot;118727206&quot;</span> <span class="na">QID=</span><span class="s">&quot;Q66628&quot;</span><span class="nt">&gt;</span>
Dr. Dr. Lehr (CDU): Meine Damen und Herren! Es ist mir ein besonderer Vorzug, der verehrten Kollegin Dr. Weber selbst da in allen Teilen zustimmen zu können, wo sie ihre Zweifel an der Bonität des Männerstaates geäußert hat. [...]
<span class="nt">&lt;/red&gt;</span>
</pre></div>
</div>
<p>Allgemein wird die Funktion der Person direkt aus dem Text extrahiert, für Abgeordnete wird diese auf Basis des Vorhandenseins einer Fraktions-/Gruppen-Angabe gesetzt. Es werden vier Positionsgruppen vergeben, dabei jeweils nur diejenige Position, in der die Person sprach: Sitzungsvorstand, Abgeordnete:r, Bundesregierung und Bundesrat. Der Sitzungsvorstand bezieht sich auf (Vize-)Präsident:innen des Bundestags. In den ersten beiden Perioden kann hier der:die Schriftführer:in enthalten sein. Alle Vertreter:innen des Sitzungsvorstands sind immer auch Abgeordnete. Mitglieder der Bundesregierung sind in der Regel ebenfalls Abgeordnete; neben den eigentlichen Bundesregierungsmitgliedern (Kanzler:in und Minister:innen), können Staatssekretäre die Bundesregierung vertreten; deshalb wird ihnen in diesen Instanzen „Bundesregierung“ als Gruppe zugewiesen. Eine fünfte mögliche Gruppe kommt in dem Goldstandard-Korpus nicht vor und spricht allgemein nur sehr selten: der Bundespräsident. Auch echte Gast-Redner:innen, wie in Kapitel zwei geschildert, kommen im Goldstandard-Korpus ebenfalls nicht vor.</p>
<p>Bis einschließlich zur 11. Bundestagsperiode wurde nur der Nachname des:der Redner:in sowie je nachdem, ob die Person Abgeordnete:r, Teil der Sitzungsleitung oder der Bundesregierung war, die Fraktion oder Funktion angegeben. Bei Abgeordneten, deren Nachnamen in dieser Periode und Fraktion mehrmals vorkamen, wurde zusätzlich noch der Ort angegeben. Dass bei Frauen bis zur 11. Periode ein „Frau“ vorangestellt wurde, kann wie die weiteren Informationen zur Filterung für das Personen-Matching genutzt werden. Bei Bedarf kann auch der jeweilige Name zu dem Redezeitpunkt (relevant bei Nachnamens-Veränderungen) noch in die Filterung einfließen.</p>
<p>In diesem Prozess wird besonderer Wert auf Überprüfungen und das Erkennen von Anomalien gelegt und in einer Reihe von Fällen werden die Redebeiträge manuell zugeordnet. Letzteres ist beispielsweise notwendig, da die Stammdaten zwar Namensänderungen modellieren können, die Parteizugehörigkeit dagegen unveränderbar ist und nur die letzte Partei angegeben ist. Gerade in den ersten Perioden gibt es jedoch viele Parteiübertritte, wie auch in den letzten vorliegenden Perioden beispielsweise von der CDU zur AfD.</p>
<p>Dies könnte wie die eigentliche Auszeichnung händisch passieren, hierbei ist jedoch das Fehlerpotenzial sehr hoch, eine kontrollierte automatisierte Verarbeitung ist schneller und von besserer Qualität. Für diesen Prozess sind die nachfolgenden Schritte notwendig. Diese sind jedoch nicht nacheinander abgeschlossen, sondern wurden im Entwicklungsprozess iterativ verbessert und überprüft:</p>
<ol class="simple">
<li><p>Erstellung Abgeordneten-Tabelle</p></li>
<li><p>Erstellung ID-Tabelle aller Abgeordneter, Regierungsmitglieder &amp; Bundesratsmitglieder</p></li>
<li><p>Rede-Matching und Anreicherung XML-Dateien</p></li>
</ol>
<section id="erstellung-abgeordneten-tabelle">
<h3>3.3.3.1 Erstellung Abgeordneten-Tabelle<a class="headerlink" href="#erstellung-abgeordneten-tabelle" title="Link zu dieser Überschrift">#</a></h3>
<p>Analog zum OP-Korpus werden für den ersten Schritt die Abgeordneten aus den Stammdaten des Bundestags extrahiert:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parsen der Stammdaten-XML-Datei</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;../data/raw/MDB_STAMMDATEN.XML&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

<span class="c1"># Anlegen des Dataframes für die Politiker:innen</span>
<span class="n">mdbs_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;date_of_birth&quot;</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">,</span> <span class="s2">&quot;periods&quot;</span><span class="p">,</span> <span class="s2">&quot;since&quot;</span><span class="p">,</span> <span class="s2">&quot;until&quot;</span><span class="p">]</span>
<span class="n">mdbs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">mdbs_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nachdem die Daten geparst wurden und die Dataframe-Struktur angelegt ist, wird über alle MDB-Tags in den Stammdaten iteriert und die grundsätzlichen Daten extrahiert: ID, Geburtstag, Partei und Geschlecht.</p>
<p>Für jede:n Abgeordnete:n wird eine Liste aller Perioden erstellt, in denen er oder sie im Bundestag waren. Hiermit wird im Matching-Schritt verhindert werden, dass Fehlmatches von Personen mit dem gleichen Namen geschehen, die in einer anderen Periode im Bundestag saßen.</p>
<p>Zuletzt wird über alle Namen der Person iteriert, innerhalb des <code class="docutils literal notranslate"><span class="pre">&lt;NAMEN&gt;</span></code>-Tags in der XML-Datei sind die Tags <code class="docutils literal notranslate"><span class="pre">&lt;NACHNAME&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;VORNAME&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;ORTSZUSATZ&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;ADEL&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;ANREDE_TITEL&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;AKAD_TITEL&gt;</span></code>, sowie zur Auszeichnung der Namens-Gültigkeit <code class="docutils literal notranslate"><span class="pre">&lt;HISTORIE_VON&gt;</span></code> und <code class="docutils literal notranslate"><span class="pre">&lt;HISTORIE_BIS&gt;</span></code>. Bei vielen Abgeordneten gibt es hier nur einen einziges <code class="docutils literal notranslate"><span class="pre">&lt;NAME&gt;</span></code>-Tag in den <code class="docutils literal notranslate"><span class="pre">&lt;NAMEN&gt;</span></code>, aber bei allen Abgeordneten, bei den sich Nachname beispielsweise durch Heirat, der Ortzusatz durch Umzug (dieser wird nur angegeben, wenn es mehrere Personen mit dem gleichen (Nach-)Namen in der Periode und Partei gibt) oder der Anrede-Titel durch Promotion oder Titelentzug verändert hat, gibt es hier mehrere Einträge.
Besonderes Augenmerk wird an dieser Stelle auf die Zusammensetzung der Nachnamen von Menschen Nachnamen ehemaliger Adelsgeschlechter gelegt. Diese werden in den Stammdaten abweichend vom deutschen Namensrecht nicht als Teil des Nachnamens hinterlegt. Stattdessen sind sie aufgeteilt in den historischen Adelstitel und Präfix, in den Stammdaten sieht das folgendermaßen aus:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;NAME&gt;</span>
  <span class="nt">&lt;NACHNAME&gt;</span>Guttenberg<span class="nt">&lt;/NACHNAME&gt;</span>
  <span class="nt">&lt;VORNAME&gt;</span>Karl-Theodor<span class="nt">&lt;/VORNAME&gt;</span>
  <span class="nt">&lt;ORTSZUSATZ/&gt;</span>
  <span class="nt">&lt;ADEL&gt;</span>Frhr.<span class="nt">&lt;/ADEL&gt;</span>
  <span class="nt">&lt;PRAEFIX&gt;</span>zu<span class="nt">&lt;/PRAEFIX&gt;</span>
  <span class="nt">&lt;ANREDE_TITEL&gt;</span>Dr.<span class="nt">&lt;/ANREDE_TITEL&gt;</span>
  <span class="nt">&lt;AKAD_TITEL&gt;</span>Dr.<span class="nt">&lt;/AKAD_TITEL&gt;</span>
  <span class="nt">&lt;HISTORIE_VON&gt;</span>08.05.2007<span class="nt">&lt;/HISTORIE_VON&gt;</span>
  <span class="nt">&lt;HISTORIE_BIS&gt;</span>23.02.2011<span class="nt">&lt;/HISTORIE_BIS&gt;</span>
<span class="nt">&lt;/NAME&gt;</span>
</pre></div>
</div>
<p>Für jede Änderung im Bereich des <code class="docutils literal notranslate"><span class="pre">&lt;NAMEN&gt;</span></code>-Tags wird eine Zeile in der Tabelle der Politiker:innen erstellt, für die Zeilen in der Tabelle gibt es also keinen Primärschlüssel, jede ID kann mehrmals vorkommen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">mdb</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mdb</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;MDB&#39;</span><span class="p">:</span>
        <span class="n">mdb_id</span> <span class="o">=</span> <span class="n">mdb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="n">date_of_birth</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">mdb</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="n">gender</span> <span class="o">=</span> <span class="n">mdb</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="n">party</span> <span class="o">=</span> <span class="n">mdb</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        
        <span class="c1"># </span>
        <span class="n">mdb_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">mdbs_columns</span><span class="p">)</span>
        <span class="n">period</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">periode</span> <span class="ow">in</span> <span class="n">mdb</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
            <span class="n">period</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">periode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">mdb</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="c1"># Zusammensetzung historischer Adelstiteln in den Stammdaten</span>
            <span class="n">imagined_adel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            
            <span class="c1"># Nur Titel, z.B. &quot;Graf Lambsdorf&quot; oder Titel und Präfix z.B. &quot;Graf von Guttenberg&quot;</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">imagined_adel</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span>
                            <span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="c1"># Nur Präfix, z.B. &quot;von Notz&quot;</span>
            <span class="k">elif</span> <span class="n">name</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">imagined_adel</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>

            <span class="n">last_name</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">imagined_adel</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="n">imagined_adel</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="n">date_since</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="s2">&quot;1949-01-01&quot;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="n">date_until</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

            <span class="c1"># Falls kein Ablaufdatum (HISTORIE_BIS) im vorherigen Namenstag  gesetzt worden ist</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mdb_temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mdb_temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mdb_temp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;until&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">():</span>
                    <span class="n">mdb_temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mdb_temp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;until&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_since</span>

            <span class="c1"># Infos an temporäre Tabelle anhängen</span>
            <span class="n">mdb_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mdb_temp</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">mdb_id</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">date_of_birth</span><span class="p">,</span>
                                                           <span class="n">name</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">party</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">date_since</span><span class="p">,</span> <span class="n">date_until</span><span class="p">]],</span>
                                                           <span class="n">columns</span><span class="o">=</span><span class="n">mdbs_columns</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Tabelle der Politiker:innen mit den Einträgen aktualisieren</span>
        <span class="n">mdbs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mdbs</span><span class="p">,</span> <span class="n">mdb_temp</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdbs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>gender</th>
      <th>date_of_birth</th>
      <th>place</th>
      <th>party</th>
      <th>periods</th>
      <th>since</th>
      <th>until</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11000001</td>
      <td>Manfred</td>
      <td>Abelein</td>
      <td>männlich</td>
      <td>1930-10-20</td>
      <td>None</td>
      <td>CDU</td>
      <td>[5, 6, 7, 8, 9, 10, 11]</td>
      <td>1965-10-19</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11000002</td>
      <td>Ernst</td>
      <td>Achenbach</td>
      <td>männlich</td>
      <td>1909-04-09</td>
      <td>None</td>
      <td>FDP</td>
      <td>[3, 4, 5, 6, 7]</td>
      <td>1957-10-15</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11000003</td>
      <td>Annemarie</td>
      <td>Ackermann</td>
      <td>weiblich</td>
      <td>1913-05-26</td>
      <td>None</td>
      <td>CDU</td>
      <td>[2, 3, 4]</td>
      <td>1953-10-06</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11000004</td>
      <td>Else</td>
      <td>Ackermann</td>
      <td>weiblich</td>
      <td>1933-11-06</td>
      <td>None</td>
      <td>CDU</td>
      <td>[11, 12]</td>
      <td>1990-10-03</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11000005</td>
      <td>Ulrich</td>
      <td>Adam</td>
      <td>männlich</td>
      <td>1950-06-09</td>
      <td>None</td>
      <td>CDU</td>
      <td>[12, 13, 14, 15, 16]</td>
      <td>1990-12-20</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4638</th>
      <td>11005266</td>
      <td>Nicolas</td>
      <td>Zippelius</td>
      <td>männlich</td>
      <td>1987-08-01</td>
      <td>None</td>
      <td>CDU</td>
      <td>[20]</td>
      <td>2021-10-26</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>4639</th>
      <td>11005267</td>
      <td>Armand</td>
      <td>Zorn</td>
      <td>männlich</td>
      <td>1988-07-18</td>
      <td>None</td>
      <td>SPD</td>
      <td>[20]</td>
      <td>2021-10-26</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>4640</th>
      <td>11005268</td>
      <td>Katrin</td>
      <td>Zschau</td>
      <td>weiblich</td>
      <td>1976-06-09</td>
      <td>None</td>
      <td>SPD</td>
      <td>[20]</td>
      <td>2021-10-26</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>4641</th>
      <td>11005273</td>
      <td>Claudia</td>
      <td>Raffelhüschen</td>
      <td>weiblich</td>
      <td>1968-11-07</td>
      <td>None</td>
      <td>FDP</td>
      <td>[20]</td>
      <td>2021-10-26</td>
      <td>2023-06-30</td>
    </tr>
    <tr>
      <th>4642</th>
      <td>11005289</td>
      <td>Clara</td>
      <td>Bünger</td>
      <td>weiblich</td>
      <td>1986-07-04</td>
      <td>None</td>
      <td>DIE LINKE.</td>
      <td>[20]</td>
      <td>2022-01-05</td>
      <td>2023-06-30</td>
    </tr>
  </tbody>
</table>
<p>4643 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mdbs</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4366
</pre></div>
</div>
</div>
</div>
<p>Die Tabelle enthält mit den Stammdaten des Bundestags mit dem Stand 7. April 2022 damit 4643 Einträge, diese verteilen sich auf 4366 Abgeordnete.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exportieren</span>
<span class="n">mdbs</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s2">&quot;../data/evaluation/matching_data/mdbs.feather&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="erstellung-id-tabelle-aller-abgeordneter-regierungsmitglieder-bundesratsmitglieder">
<h3>3.3.3.2 Erstellung ID-Tabelle aller Abgeordneter, Regierungsmitglieder &amp; Bundesratsmitglieder<a class="headerlink" href="#erstellung-id-tabelle-aller-abgeordneter-regierungsmitglieder-bundesratsmitglieder" title="Link zu dieser Überschrift">#</a></h3>
<p>Im OP-Korpus gibt es viele Redner:innen, die als Gäste ausgezeichnet sind, diese haben zusätzlich häufig auch keine ID-Zuweißung. Etwas, das vor allem Staatssekretär:innen und -Minister:innen betrifft. In dem Goldstandard-Korpus soll jedoch für alle Redner:innen ein eindeutiger Identifier existieren und tatsächlich gibt es für alle Sprecher:innen in der Stichprobe eine Wikipedia-QID. Diese wird in dem Testdatensatz entsprechend als eindeutiger Identifier genutzt. Daneben werden auch alle Redebeiträge, soweit diese für die Sprecher:in vorliegen, mit dem der Stammdaten-ID und der GND (Gemeinsame Normdatei) annotiert.</p>
<p>Für diese ID-Tabelle gibt es zwei Datenquellen: Eine SPARQL-Wikidata-Abfrage, die alle in Wikidata hinterlegten Bundestagsmitglieder abfragt und daneben eine Wikidata-Abfrage für eine händisch erstellte Liste von 48 Politiker:innen und ihrer QID, die in den Testdaten vorkommen, jedoch entweder nicht Abgeordnete sind oder bei deren Abfrage Probleme vorlagen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bibliothek zur Arbeit mit Wikidata SPARQL</span>
<span class="kn">from</span> <span class="nn">SPARQLWrapper</span> <span class="kn">import</span> <span class="n">SPARQLWrapper</span><span class="p">,</span> <span class="n">JSON</span>

<span class="c1"># Import der händisch erstellten QID-Tabelle von Politiker:innen</span>
<span class="n">non_mdbs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/evaluation/matching_data/government_politicians_qid.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Für die Abfrage gibt es die Funktion get_pol_info(), die auf Basis einer SPARQL-Abfrage ein Dataframe mit der Antworten zurückgibt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_pol_info</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="n">sparql</span> <span class="o">=</span> <span class="n">SPARQLWrapper</span><span class="p">(</span><span class="s2">&quot;https://query.wikidata.org/sparql&quot;</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setReturnFormat</span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span>

    <span class="c1"># Umwandlung in ein Dataframe</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">sparql</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="n">table_sparql</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="s1">&#39;bindings&#39;</span><span class="p">])</span>

    <span class="c1"># Modellierung des Dataframes basierend auf den Antwortspalten</span>
    <span class="n">columns_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;subjLabel.value&quot;</span><span class="p">:</span> <span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="s2">&quot;birthNameLabel.value&quot;</span><span class="p">:</span> <span class="s2">&quot;birth_name&quot;</span><span class="p">,</span> <span class="s2">&quot;date.value&quot;</span><span class="p">:</span> <span class="s2">&quot;date_of_birth&quot;</span><span class="p">,</span>
        <span class="s2">&quot;genderLabel.value&quot;</span><span class="p">:</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;subj.value&quot;</span><span class="p">:</span> <span class="s2">&quot;qid&quot;</span><span class="p">,</span> <span class="s2">&quot;gnd.value&quot;</span><span class="p">:</span> <span class="s2">&quot;gnd&quot;</span><span class="p">,</span> <span class="s2">&quot;partyShort.value&quot;</span><span class="p">:</span> <span class="s2">&quot;party&quot;</span>
    <span class="p">}</span>

    <span class="n">columns_copy</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">columns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
    
    <span class="n">table_sparql</span> <span class="o">=</span> <span class="n">table_sparql</span><span class="p">[</span><span class="n">columns_copy</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

    <span class="c1"># Extrahierung der QID aus der Wikidata-URL (verbesserungswürdig)</span>
    <span class="n">replace_qid</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;qid&#39;</span><span class="p">)</span>
    <span class="n">table_sparql</span><span class="o">.</span><span class="n">qid</span> <span class="o">=</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^.*(?P&lt;qid&gt;Q.*)&quot;</span><span class="p">,</span> <span class="n">replace_qid</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Umwandlung des Geburtstags-Datumsformats</span>
    <span class="k">if</span> <span class="s2">&quot;date_of_birth&quot;</span> <span class="ow">in</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">table_sparql</span><span class="o">.</span><span class="n">date_of_birth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">table_sparql</span><span class="o">.</span><span class="n">date_of_birth</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

    <span class="c1"># Anfügen eines leeren GND-Felds, sofern dieses fehlt</span>
    <span class="k">if</span> <span class="s2">&quot;gnd&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">table_sparql</span><span class="p">[</span><span class="s2">&quot;gnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Anfügen eines leeren Partei-Felds, sofern dies fehlt / in dieser Version aus Modellierungsgründen nicht enthalten</span>
    <span class="k">if</span> <span class="s2">&quot;party&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_sparql</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">table_sparql</span><span class="p">[</span><span class="s2">&quot;party&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="n">table_sparql</span>
</pre></div>
</div>
</div>
</div>
<p>Mit dieser Funktion werden die Abgeordneten von Wikidata abgerufen um ihre QID zu erhalten:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sparql_mdb_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT Distinct ?subjLabel ?birthNameLabel ?genderLabel ?date ?subj ?gnd</span>
<span class="s2">WHERE</span>
<span class="s2">{</span>
<span class="s2">    ?subj wdt:P39 wd:Q1939555 .</span>
<span class="s2">    OPTIONAL { ?subj wdt:P1477 ?birthName . }</span>
<span class="s2">    OPTIONAL { ?subj wdt:P21 ?gender . }</span>
<span class="s2">    OPTIONAL { ?subj wdt:P569 ?date . }</span>
<span class="s2">    OPTIONAL { ?subj wdt:P227 ?gnd . }</span>

<span class="s2">    SERVICE wikibase:label { bd:serviceParam wikibase:language &quot;de&quot; }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">politician_sparql</span> <span class="o">=</span> <span class="n">get_pol_info</span><span class="p">(</span><span class="n">sparql_mdb_query</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Das Matching der Stammdaten-ID mit der QID läuft weitgehend automatisch, bei 14 der über 4000 Politiker:innen muss das Matching jedoch manuell erfolgen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">match_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;11000454&quot;</span><span class="p">:</span> <span class="s2">&quot;Q2502436&quot;</span><span class="p">,</span> <span class="c1"># Ursula Eid</span>
    <span class="s2">&quot;11001833&quot;</span><span class="p">:</span> <span class="s2">&quot;Q102456&quot;</span><span class="p">,</span> <span class="c1"># Nazi Franz Richter / Fritz Rößler</span>
    <span class="s2">&quot;11002016&quot;</span><span class="p">:</span> <span class="s2">&quot;Q69677&quot;</span><span class="p">,</span> <span class="c1"># Renate Schmidt</span>
    <span class="s2">&quot;11002078&quot;</span><span class="p">:</span> <span class="s2">&quot;Q2530&quot;</span><span class="p">,</span> <span class="c1"># Gerhard Schröder</span>
    <span class="s2">&quot;11003023&quot;</span><span class="p">:</span> <span class="s2">&quot;Q71359&quot;</span><span class="p">,</span> <span class="c1"># Annegret Kramp-Karrenbauer</span>
    <span class="s2">&quot;11003733&quot;</span><span class="p">:</span> <span class="s2">&quot;Q106497&quot;</span><span class="p">,</span> <span class="c1"># Hüseyin-Kenan Aydin</span>
    <span class="s2">&quot;11004106&quot;</span><span class="p">:</span> <span class="s2">&quot;Q109309&quot;</span><span class="p">,</span> <span class="c1"># Agnes Malczak</span>
    <span class="s2">&quot;11004157&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1045675&quot;</span><span class="p">,</span> <span class="c1"># Carsten Sieling</span>
    <span class="s2">&quot;11004167&quot;</span><span class="p">:</span> <span class="s2">&quot;Q76658&quot;</span><span class="p">,</span> <span class="c1"># Frank-Walter Steinmeier</span>
    <span class="s2">&quot;11004176&quot;</span><span class="p">:</span> <span class="s2">&quot;Q61386&quot;</span><span class="p">,</span> <span class="c1"># Wolfgang Tiefensee</span>
    <span class="s2">&quot;11004445&quot;</span><span class="p">:</span> <span class="s2">&quot;Q109375&quot;</span><span class="p">,</span> <span class="c1"># Oliver Wittke</span>
    <span class="s2">&quot;11004837&quot;</span><span class="p">:</span> <span class="s2">&quot;Q40998599&quot;</span><span class="p">,</span> <span class="c1">#Zaklin Nastic</span>
    <span class="s2">&quot;11004972&quot;</span><span class="p">:</span> <span class="s2">&quot;Q108179918&quot;</span><span class="p">,</span> <span class="c1"># Zeki Gökhan</span>
    <span class="s2">&quot;11005059&quot;</span><span class="p">:</span> <span class="s2">&quot;Q108738246&quot;</span><span class="p">,</span> <span class="c1"># Schahina Gambir</span>
    <span class="s2">&quot;11005289&quot;</span><span class="p">:</span> <span class="s2">&quot;Q110421439&quot;</span> <span class="c1"># Clara Bünger</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Auf Basis der manuellen QID wird noch mal eine SPARQL-Abfrage gesendet, hierfür gibt es die folgende Funktion <code class="docutils literal notranslate"><span class="pre">get_pol_by_qid</span></code>, die auf Basis der QID die Informationen zurückgibt. Diese wird in einem späteren Schritt auch für die Nicht-Abgeordneten benötigt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_pol_by_qid</span><span class="p">(</span><span class="n">manual_match</span><span class="p">):</span>
    <span class="n">sparql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT Distinct ?subjLabel ?birthNameLabel ?genderLabel ?date ?subj ?gnd</span>
<span class="s2">    WHERE</span>
<span class="s2">    {{</span>
<span class="s2">        BIND(wd:</span><span class="si">{}</span><span class="s2"> AS ?subj).</span>
<span class="s2">        OPTIONAL {{ ?subj wdt:P1477 ?birthName . }}</span>
<span class="s2">        OPTIONAL {{ ?subj wdt:P21 ?gender . }}</span>
<span class="s2">        OPTIONAL {{ ?subj wdt:P569 ?date . }}</span>
<span class="s2">        OPTIONAL {{ ?subj wdt:P227 ?gnd . }}</span>

<span class="s2">        SERVICE wikibase:label {{ bd:serviceParam wikibase:language &quot;de&quot; }}</span>
<span class="s2">    }}&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">manual_match</span><span class="p">)</span>
    <span class="n">pol_sparql</span> <span class="o">=</span> <span class="n">get_pol_info</span><span class="p">(</span><span class="n">sparql_query</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pol_sparql</span>
</pre></div>
</div>
</div>
</div>
<p>Die ID-Tabelle, die später für die XML-Anreicherung zusammen mit der Tabelle der Abgeordneten genutzt wird, benötigt entsprechend die Spalten der Stammdaten-ID (hier mdb_id), die GND, die QID und den vollen Namen. Letzteres als Schlüssel für das Matching von Nicht-Abgeordneten:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politician_identifier_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mdb_id&quot;</span><span class="p">,</span> <span class="s2">&quot;gnd&quot;</span><span class="p">,</span> <span class="s2">&quot;qid&quot;</span><span class="p">,</span> <span class="s2">&quot;full_name&quot;</span><span class="p">]</span>
<span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">politician_identifier_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Für das automatisierte Matching der Bundestags-ID mit der QID wird über das Dataframe der Abgeordneten iteriert. Der Algorithmus versucht dabei, die Abgeordneten mithilfe ihres Geburtstags und Namens zu matchen. Dabei kümmert der Code sich um bestimmte Sonderfälle wie manuellen Matches oder Abgeordnete, bei denen der vollständige Name nicht identisch mit den Wikidata-Daten ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mdb</span> <span class="ow">in</span> <span class="n">mdbs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">mdb</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span> <span class="n">mdb</span><span class="o">.</span><span class="n">last_name</span><span class="p">])</span>
    <span class="n">manual_match</span> <span class="o">=</span> <span class="n">match_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mdb</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
    <span class="c1"># Falls kein manueller Match vorliegt, werden potenzieller Matches auf Basis des Geburstags und vollen Namens gesucht</span>
    <span class="k">if</span> <span class="n">manual_match</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">potential_matches_birth</span> <span class="o">=</span> <span class="n">politician_sparql</span><span class="p">[</span><span class="n">politician_sparql</span><span class="o">.</span><span class="n">date_of_birth</span> <span class="o">==</span> <span class="n">mdb</span><span class="o">.</span><span class="n">date_of_birth</span><span class="p">]</span>
        <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">potential_matches_birth</span><span class="p">[</span><span class="n">potential_matches_birth</span><span class="o">.</span><span class="n">full_name</span> <span class="o">==</span> <span class="n">full_name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">politician_sparql</span><span class="p">[</span><span class="n">politician_sparql</span><span class="o">.</span><span class="n">qid</span> <span class="o">==</span> <span class="n">manual_match</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">get_pol_by_qid</span><span class="p">(</span><span class="n">manual_match</span><span class="p">)</span>

    <span class="c1"># Falls nach dieser Filterung keine potenziellen Matches passiert sind wird nur auf Basis des letzten Nachname-Worts gemacht</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">potential_matches_birth</span><span class="p">[</span><span class="n">potential_matches_birth</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">full_name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)]</span>
        
        <span class="c1"># Sofern auch dadurch kein Match erzeugt wurde, wird auf Basis des Vornamens gematched</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">potential_matches_birth</span><span class="p">[(</span><span class="n">potential_matches_birth</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">full_name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">|</span>
                                                        <span class="p">(</span><span class="n">potential_matches_birth</span><span class="o">.</span><span class="n">birth_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">full_name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))]</span>
            
    <span class="c1"># Falls es zuviele potenzielle Matches gibt, aber alle die gleiche QID haben, also identisch sind</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">potential_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Match</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">mdb</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">potential_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">gnd</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">potential_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">full_name</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="n">politician_identifier_columns</span><span class="p">)</span>
        <span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">politician_identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No Match: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">full_name</span><span class="p">,</span> <span class="n">mdb</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_sparql</span><span class="p">[</span><span class="n">politician_sparql</span><span class="o">.</span><span class="n">date_of_birth</span> <span class="o">==</span> <span class="n">mdb</span><span class="o">.</span><span class="n">date_of_birth</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No Match: Peter Altmaier - 11002617 - 0
</pre></div>
</div>
</div>
</div>
<p>Nun folgt die Ergänzung der Liste um die Daten der Nicht-Abgeordneten, hierfür wird über die Tabelle <code class="docutils literal notranslate"><span class="pre">non_mdbs</span></code> iteriert und per SPARQL wieder die entsprechenden Informationen abgefragt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">non_mdb</span> <span class="ow">in</span> <span class="n">non_mdbs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">potential_matches</span> <span class="o">=</span> <span class="n">get_pol_by_qid</span><span class="p">(</span><span class="n">non_mdb</span><span class="o">.</span><span class="n">qid</span><span class="p">)</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">potential_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">gnd</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">non_mdb</span><span class="o">.</span><span class="n">qid</span><span class="p">,</span>
                           <span class="n">non_mdb</span><span class="o">.</span><span class="n">family_name</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="n">politician_identifier_columns</span><span class="p">)</span>
    <span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">politician_identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Die Tabelle ist nun unsortiert und enthält Komplett-Duplikate wie auch QID-Duplikate, dies wird im letzten Schritt bereinigt. Zudem wird die Variable <code class="docutils literal notranslate"><span class="pre">multi_role</span></code> gesetzt, die als kleines Hilfsmittel für den nächsten Schritt Abgeordnete identifiziert, die auch andere Rollen (z.B. Regierungsvertreter:innen) wahrnehmen. Diese Liste ist hinsichtlich letzterer Variable nicht vollständig.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aufräumen der Daten</span>
<span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mdb_id&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na_position</span> <span class="o">=</span> <span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="n">politician_identifier</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span><span class="o">~</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;qid&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)]</span>

<span class="c1"># multi_role Setzen</span>
<span class="n">politician_identifier</span><span class="p">[</span><span class="s2">&quot;multi_role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">non_mdbs</span><span class="o">.</span><span class="n">qid</span><span class="p">)</span>
<span class="n">politician_identifier</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">mdb_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;multi_role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Speichern</span>
<span class="n">politician_identifier</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../data/evaluation/matching_data/politician_qid_gnd.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wie eingangs geschrieben ist die Entwicklung dieses Codes und des Matchings ein iterativer Prozess, in dem durchgehend die Daten im Blick bleiben müssen, um Fehlmatches zu verhindern. Als Ergebnis gibt es die folgende Tabelle <code class="docutils literal notranslate"><span class="pre">politician_identifier</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">politician_identifier</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mdb_id</th>
      <th>gnd</th>
      <th>qid</th>
      <th>full_name</th>
      <th>multi_role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4641</th>
      <td>11005289</td>
      <td>1240702027</td>
      <td>Q110421439</td>
      <td>Clara Bünger</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4640</th>
      <td>11005273</td>
      <td>NaN</td>
      <td>Q108706759</td>
      <td>Claudia Raffelhüschen</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4639</th>
      <td>11005268</td>
      <td>NaN</td>
      <td>Q108760646</td>
      <td>Katrin Zschau</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4638</th>
      <td>11005267</td>
      <td>NaN</td>
      <td>Q108708654</td>
      <td>Armand Zorn</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4637</th>
      <td>11005266</td>
      <td>NaN</td>
      <td>Q108760623</td>
      <td>Nicolas Zippelius</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4656</th>
      <td></td>
      <td>1066381364</td>
      <td>Q1893046</td>
      <td>Huber</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4657</th>
      <td></td>
      <td></td>
      <td>Q813145</td>
      <td>Hübner</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4658</th>
      <td></td>
      <td>1025392825</td>
      <td>Q1874646</td>
      <td>Kattenstroth</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4664</th>
      <td></td>
      <td>124637205</td>
      <td>Q993550</td>
      <td>Merk</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4690</th>
      <td></td>
      <td>1168145732</td>
      <td>Q44212668</td>
      <td>Becker</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>4387 rows × 5 columns</p>
</div></div></div>
</div>
</section>
<section id="rede-matching-und-anreicherung-der-xml-dateien">
<h3>3.3.3.3 Rede-Matching und Anreicherung der XML-Dateien<a class="headerlink" href="#rede-matching-und-anreicherung-der-xml-dateien" title="Link zu dieser Überschrift">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;enrich_xml_data.log&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Für die automatisierte Anreicherung der Redebeiträge wird über alle XML-Dateien und alle Redebeiträge iteriert und ein mehrstufiger Extraktions- und Matchingprozess durchgeführt.</p>
<p>Neben den bereits vorhandenen Datenquellen, den Dataframes <code class="docutils literal notranslate"><span class="pre">politician_identifier</span></code> und <code class="docutils literal notranslate"><span class="pre">mdbs</span></code>, werden auch noch Informationen zu den Fraktionen und Parteien benötigt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fractions_party_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/evaluation/matching_data/fractions_party_list.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> 
                                   <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">),</span>
                                               <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)})</span>
<span class="n">fractions_party_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>party</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fraktionslos</td>
      <td>[SSW, AfD, Bündnis 90/GRÜNE, GRÜNE, BÜNDNIS 90...</td>
      <td>[fraktionslos, Fraktionslos]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AfD</td>
      <td>[AfD]</td>
      <td>[AfD]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DIE LINKE</td>
      <td>[PDS, PDS/LL, DIE LINKE.]</td>
      <td>[DIE LINKE]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PDS</td>
      <td>[PDS, PDS/LL, DIE LINKE.]</td>
      <td>[PDS]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PDS/Linke Liste</td>
      <td>[PDS, PDS/LL, DIE LINKE.]</td>
      <td>[PDS/Linke Liste]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BÜNDNIS 90/DIE GRÜNEN</td>
      <td>[BÜNDNIS 90/DIE GRÜNEN, GRÜNE, DIE GRÜNEN/BÜND...</td>
      <td>[BÜNDNIS 90/DIE GRÜNEN, Bündnis 90/GRÜNE, BÜND...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GRÜNE</td>
      <td>[BÜNDNIS 90/DIE GRÜNEN, GRÜNE, DIE GRÜNEN/BÜND...</td>
      <td>[GRÜNE]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FDP</td>
      <td>[FDP]</td>
      <td>[FDP, F.D.P.]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>SPD</td>
      <td>[SPD]</td>
      <td>[SPD]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CDU/CSU</td>
      <td>[CDU, CSU, CSUS, CVP, DSU]</td>
      <td>[CDU, CSU, CSUS, CVP, CDU/CSU, CDU/ CSU, CDU/C...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>DP</td>
      <td>[DP]</td>
      <td>[DP]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DP/FVP</td>
      <td>[DP, FVP]</td>
      <td>[DP [FVP]]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>FU</td>
      <td>[FU, Z, BP]</td>
      <td>[FU]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Z</td>
      <td>[DZP, Z]</td>
      <td>[Z]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WAV</td>
      <td>[WAV]</td>
      <td>[WAV]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>KPD</td>
      <td>[KPD]</td>
      <td>[KPD]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NR</td>
      <td>[NR]</td>
      <td>[NR]</td>
    </tr>
    <tr>
      <th>17</th>
      <td>GB/BHE</td>
      <td>[GB/BHE, GB/ BHE]</td>
      <td>[GB/BHE]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>BP</td>
      <td>[BP]</td>
      <td>[BP]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Diese Tabelle <code class="docutils literal notranslate"><span class="pre">fractions_party_list</span></code>, die unvollständig ist und händisch für die Stichprobe erstellt wurde, erfüllt zwei Funktionen: Das Matching verschiedener Schreibweisen auf den Fraktionsnamen (z. B. F.D.P. und FDP zu FDP) und den Abgleich von Fraktions- und Parteizugehörigkeit: In den Stammdaten des Bundestags ist nur die aktuellste Parteizugehörigkeit enthalten, in dem Golstandard-Korpus soll jedoch auch die Partei zum Redezeitpunkt angegeben werden. Um zu verhindern, dass hier die falsche Partei assoziiert wird, müssen diese Wechsel geloggt werden, um sie manuell korrigieren zu können. Auch diese Daten sind nicht komplett vollständig: Für alle Redner:innen, die zu keinem Zeitpunkt ein Abgeordneten-Mandat besessen haben, muss die Partei zukünftig noch ergänzt werden, so fehlt die Parteizugehörigkeit bei den meisten Bundesratsmitgliedern.</p>
<p>Hinsichtlich der Abgeordneten gibt es einen guten Datenschatz in den Protokollen, um die Redner:innen-Zuordnung durchzuführen: Den Namen, die Fraktion, ggf. den Ortzusatz und bis zur 12. Periode das Geschlecht. Für alle anderen Redner:innen ist jeweils nur der Name und die Funktion in den Redebeiträgen vorhanden, um den Abgleich durchzuführen. Um im Detail nachprüfen zu können, welche Matches im Ablauf passieren, wird das Dataframe <code class="docutils literal notranslate"><span class="pre">unknown_politician</span></code> mit unbekannten Politiker:innen (Politiker:innen ohne Abgeordnetenmandat) erstellt und dieses im weiteren Verlauf mit den Matches gefüllt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unknown_politician_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="s2">&quot;periods&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;matched_mdb_id&quot;</span><span class="p">,</span> <span class="s2">&quot;matched_qid&quot;</span><span class="p">,</span><span class="s2">&quot;matched_gnd&quot;</span><span class="p">]</span>
<span class="n">unknown_politician</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">unknown_politician_columns</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_unknown_politician_id</span><span class="p">(</span><span class="n">full_name_match</span><span class="p">,</span> <span class="n">name_data</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">unknown_politician</span>
    <span class="n">mdb_speech_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_periods</span><span class="p">(</span><span class="n">politician_id</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
        <span class="n">periods</span> <span class="o">=</span> <span class="n">unknown_politician</span><span class="p">[</span><span class="n">unknown_politician</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">politician_id</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">periods</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">period</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">:</span>
            <span class="n">periods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="n">unknown_politician</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">unknown_politician</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">politician_id</span><span class="p">)),</span> <span class="s1">&#39;periods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">periods</span>

    <span class="k">def</span> <span class="nf">get_unknown_id</span><span class="p">(</span><span class="n">unknown_match</span><span class="p">):</span>
        <span class="n">unknown_politician_id</span> <span class="o">=</span> <span class="n">unknown_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mdb_id</span> <span class="o">=</span> <span class="n">unknown_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">matched_mdb_id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">qid</span> <span class="o">=</span> <span class="n">unknown_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">matched_qid</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">gnd</span> <span class="o">=</span> <span class="n">unknown_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">matched_gnd</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">mdb_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span>

    <span class="c1"># Filtern auf Basis des Nachnamens</span>
    <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">unknown_politician</span><span class="p">[</span><span class="n">unknown_politician</span><span class="o">.</span><span class="n">last_name</span> <span class="o">==</span> <span class="n">last_name</span><span class="p">]</span>
    <span class="c1"># Ergebnisse filtern auf Basis der Funktion</span>
    <span class="n">politician_matches_function</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="p">[</span><span class="n">politician_matches</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="c1"># Potenzielles manuelles Match</span>
    <span class="n">manual_match</span> <span class="o">=</span> <span class="n">manual_qid_matches</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>

    <span class="c1"># Match, wenn Name und Funktion gleich sind</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches_function</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> <span class="n">get_unknown_id</span><span class="p">(</span><span class="n">politician_matches_function</span><span class="p">)</span>
        <span class="n">set_periods</span><span class="p">(</span><span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
    <span class="c1"># Match, wenn kein eindeutiges Match auf Basis der Funktion &amp; Name, nur Nachnamen; Kein Match bei manuellen Match</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">manual_match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> <span class="n">get_unknown_id</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unknown_politician</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">unknown_politician</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">unknown_politician_id</span><span class="p">),</span> <span class="s1">&#39;function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">functions</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">function</span>
        <span class="n">set_periods</span><span class="p">(</span><span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
    <span class="c1"># Manual-Match falls bereits in der Tabelle</span>
    <span class="k">elif</span> <span class="n">manual_match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unknown_politician</span><span class="p">[</span><span class="n">unknown_politician</span><span class="o">.</span><span class="n">matched_qid</span> <span class="o">==</span> <span class="n">manual_match</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">unknown_politician</span><span class="p">[</span><span class="n">unknown_politician</span><span class="o">.</span><span class="n">matched_qid</span> <span class="o">==</span> <span class="n">manual_match</span><span class="p">]</span>
        <span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> <span class="n">get_unknown_id</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span>

    <span class="c1"># Falls bisher keine eindeutigen Matches: Neue Politiker:in anlegen</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">unknown_politician_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unknown_politician</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># Versuch qid und gnd zu matchen</span>
        <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> <span class="n">get_identifier</span><span class="p">(</span><span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_identifier</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">qid</span> <span class="o">==</span> <span class="n">qid</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mdb_id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mdb_speech_id</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">qid</span> <span class="o">==</span> <span class="n">qid</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mdb_id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unknown_politician_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span>
                                                 <span class="n">function</span><span class="p">,</span> <span class="p">[</span><span class="n">period</span><span class="p">],</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span><span class="p">]],</span>
                                               <span class="n">columns</span><span class="o">=</span><span class="n">unknown_politician_columns</span><span class="p">)</span>
        <span class="n">unknown_politician</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">unknown_politician</span><span class="p">,</span> <span class="n">unknown_politician_temp</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unknown_politician_id</span><span class="p">,</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span>
</pre></div>
</div>
</div>
</div>
<p>Auch an dieser Stelle ist eine gewisse Zahl von manuellen Matches notwendig, Erstere für Abgeordnete, die zum Teil auch andere Funktionen haben. Letztere betrifft Politiker:innen ohne Mandat, in dieser Stichprobe ist hierbei nur eine Person betroffen: Kurt Becker, der ansonsten mit Helmuth Becker, der teilweise zeitlich überschneidend ebenfalls Staatssekretär war:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manual_matches</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Präsident Carstens:&quot;</span><span class="p">:</span> <span class="mi">11000321</span><span class="p">,</span>
    <span class="s2">&quot;Vizepräsidentin Petra Bläss:&quot;</span><span class="p">:</span> <span class="mi">11000189</span><span class="p">,</span>
    <span class="s2">&quot;Vizepräsident Dr. Schneider:&quot;</span><span class="p">:</span> <span class="mi">11002046</span><span class="p">,</span>
    <span class="s2">&quot;Vizepräsident Dr. Becker:&quot;</span><span class="p">:</span> <span class="mi">11000130</span><span class="p">,</span>
    <span class="s2">&quot;Ministerpräsident Lafontaine (Saarland):&quot;</span><span class="p">:</span> <span class="mi">11002715</span><span class="p">,</span>
    <span class="s2">&quot;Präsident D. Dr. Gerstenmaler:&quot;</span><span class="p">:</span> <span class="mi">11000669</span><span class="p">,</span>
    <span class="s2">&quot;Kißlinger (SPD):&quot;</span><span class="p">:</span> <span class="mi">11001104</span><span class="p">,</span>
    <span class="s2">&quot;Petra Bläss (PDS/Linke Liste):&quot;</span><span class="p">:</span> <span class="mi">11000189</span><span class="p">,</span>
    <span class="s2">&quot;Schmidt (Nürnberg) (SPD):&quot;</span><span class="p">:</span> <span class="mi">11002016</span><span class="p">,</span>
    <span class="s2">&quot;Vogel (München) (GRÜNE):&quot;</span><span class="p">:</span> <span class="mi">11002376</span><span class="p">,</span>
    <span class="s2">&quot;Uwe Lühr (FDP):&quot;</span><span class="p">:</span> <span class="mi">11001392</span><span class="p">,</span>
    <span class="s2">&quot;Dr. Arndt, Parlamentarischer Staatssekretär beim Bundesminister für Wirtschaft:&quot;</span><span class="p">:</span> <span class="mi">11000049</span><span class="p">,</span>
    <span class="s2">&quot;Jahn, Bundesminister der Justiz:&quot;</span><span class="p">:</span> <span class="mi">11001012</span>
<span class="p">}</span>

<span class="n">manual_qid_matches</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Becker, Staatssekretär, Chef des Presse- und Informationsamtes der Bundesregierung:&quot;</span><span class="p">:</span> <span class="s1">&#39;Q44212668&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Becker, Staatssekretär:&quot;</span><span class="p">:</span> <span class="s1">&#39;Q44212668&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Becker, Parl. Staatssekretär beim Bundesminister für das Post- und Fernmeldewesen:&quot;</span><span class="p">:</span> <span class="s1">&#39;Q1604393&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Für das Matching werden einige Funktionen benötigt, welche mit dem dem Redetext voranstehenden String mit den Namensdaten arbeiten: So können mit <code class="docutils literal notranslate"><span class="pre">clean_name_data()</span></code> die Namensdaten gereinigt und mit <code class="docutils literal notranslate"><span class="pre">get_group()</span></code> die Fraktion/Gruppe, mit <code class="docutils literal notranslate"><span class="pre">get_full_name()</span></code> der volle Name sowie mit <code class="docutils literal notranslate"><span class="pre">get_place()</span></code> ggf. der Ort extrahiert werden:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_name_data</span><span class="p">(</span><span class="n">clean_name_data</span><span class="p">):</span>
        <span class="c1"># Trennstrich-Umbrüche entfernen</span>
        <span class="n">clean_name_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;-(</span><span class="se">\\</span><span class="s2">n|\n)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">clean_name_data</span><span class="p">)</span>
        <span class="c1"># Umbrüche entfernen</span>
        <span class="n">clean_name_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s*(</span><span class="se">\\</span><span class="s2">n|\n)&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">clean_name_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">clean_name_data</span>

<span class="k">def</span> <span class="nf">get_group</span><span class="p">(</span><span class="n">name_data</span><span class="p">):</span>
    <span class="n">group_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^.*?(?:\(.*?\))?.*\((?P&lt;fraction&gt;.{1,25}?)\)? ?[:,(]&quot;</span>
    <span class="n">group_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">group_regex</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;fraction&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">group_regex</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    
    <span class="c1"># Vergleiche, ob die Gruppe in der Liste der möglichen Gruppen ist</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">fractions_party_list</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">group_match</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">)):</span>
        <span class="n">extracted_group</span> <span class="o">=</span> <span class="n">fractions_party_list</span><span class="p">[</span><span class="n">fractions_party_list</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">group_match</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">extracted_group</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_match</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fraktions-Match Error: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">name_data</span><span class="p">))</span>
    
    <span class="c1"># Korrigiere mögliche Fraktionsfehler in name_data</span>
    <span class="n">updated_name_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">group_match</span><span class="p">,</span> <span class="n">extracted_group</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span> <span class="k">if</span> <span class="n">extracted_group</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">name_data</span>

    <span class="k">return</span> <span class="n">extracted_group</span><span class="p">,</span> <span class="n">group_match</span><span class="p">,</span> <span class="n">updated_name_data</span>

<span class="k">def</span> <span class="nf">get_place</span><span class="p">(</span><span class="n">name_data</span><span class="p">):</span>
    <span class="n">place_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^.*\((?P&lt;place&gt;.*)\).*(?:\(.*?\)? ?):&quot;</span>
    <span class="n">place</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">place_regex</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;place&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">place_regex</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">place</span>

<span class="k">def</span> <span class="nf">get_full_name</span><span class="p">(</span><span class="n">name_data</span><span class="p">):</span>
    <span class="c1"># Regex Erklärung:</span>
    <span class="c1"># 1. Gruppe: Präsident(in)-Titel, oder &quot;Frau&quot; ausfiltern</span>
    <span class="c1"># 2. Gruppe: Bis (mehrere) Dr.-Titel, Ing.-Titel und/oder &quot;,&quot; filtern + (Dr. h.c.)</span>
    <span class="c1"># aber Namen wie &quot;Erich G. Fritz&quot; mit Punkt zulassen</span>
    <span class="c1"># 3. Gruppe: Namensgruppe, die alle Zeichen außer &quot;,&quot; und &quot;:&quot; zulässt</span>
    <span class="c1"># Ende durch &quot;,&quot;, &quot;(&quot; oder &quot;:&quot;</span>
    <span class="n">full_name_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^([^,]*dent(?:in)?|Frau)?(?:[^,]*?[rg][.] (?:h. c.|E. h.)?){0,2}(?P&lt;name&gt;[^(,:]*)[(,:]&quot;</span>
    <span class="n">full_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">full_name_regex</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">full_name_match</span>
</pre></div>
</div>
</div>
</div>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">get_function()</span></code> gibt auf Basis der Namensdaten die Funktion sowie die Funktionsgruppe zurück:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_function</span><span class="p">(</span><span class="n">name_data_function</span><span class="p">,</span> <span class="n">group_function</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">function_log</span>
    
    <span class="n">politician_function</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">presidency_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^[^M,]*?räsident(?:in)?&quot;</span>
    <span class="n">secretary_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^[^,]*, Schriftführer.*:&quot;</span>
    <span class="n">government_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^[^,]*, (?!Min|Sen)(?P&lt;government&gt;(?:Parl.*|Bun.*|Wehr.*|Staa[^(]*)):&quot;</span>
    <span class="n">federal_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^((?P&lt;federal1&gt;(?:Mini|Staa|Sena)[^\s]*).*|.*, (?P&lt;federal2&gt;(?:Min|Sta)[^(]*\(?[^(:]*)[^:]*?):&quot;</span>

    <span class="k">if</span> <span class="n">group_function</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">politician_function</span> <span class="o">=</span> <span class="s2">&quot;Abgeordnete:r&quot;</span>
        <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;Abgeordnete:r&quot;</span>
    <span class="c1"># Sitzungsvorstand: (Vize-)Präsident:in</span>
    <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">presidency_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">):</span>
        <span class="n">politician_function</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">presidency_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;Sitzungsvorstand&quot;</span>
    <span class="c1"># Sitzungsvorstand: Schriftführer</span>
    <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">secretary_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">):</span>
        <span class="n">politician_function</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">secretary_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;Sitzungsvorstand&quot;</span>
    <span class="c1"># Bundesregierung: Bundesminister:in, (Parlamentarische) Staatssekretär:in, Wehrbeauftragte</span>
    <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">government_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">):</span>
        <span class="n">politician_function</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">government_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;government&#39;</span><span class="p">)</span>
        <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;Bundesregierung&quot;</span>
        <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">government_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;government&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">government_pattern</span><span class="p">,</span>
                                                                                            <span class="n">name_data</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="c1"># Bundesrat: Ministerpräsident:in, Staatssekretär:in, Senator:in</span>
    <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">federal_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">federal_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;federal1&#39;</span><span class="p">):</span>
            <span class="n">politician_function</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">federal_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;federal1&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(([^)]*?)\)&quot;</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">):</span>
                <span class="n">politician_function</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(([^)]*?)\)&quot;</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">politician_function</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">federal_pattern</span><span class="p">,</span> <span class="n">name_data_function</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;federal2&#39;</span><span class="p">)</span>
        <span class="n">politician_function_group</span> <span class="o">=</span> <span class="s2">&quot;Bundesrat&quot;</span>

    <span class="k">return</span> <span class="n">politician_function</span><span class="p">,</span> <span class="n">politician_function_group</span>
</pre></div>
</div>
</div>
</div>
<p>Ein beispielhafter Output für diese Funktionen sähe folgendermaßen aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Marieluise Beck (Bremen) (BÜNDNIS 90/DIE GRÜ-</span>
<span class="s2">NEN):&quot;&quot;&quot;</span>
<span class="n">name_data</span> <span class="o">=</span> <span class="n">clean_name_data</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">get_group</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">get_function</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
<span class="n">place</span> <span class="o">=</span> <span class="n">get_place</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
<span class="n">full_name_match</span> <span class="o">=</span> <span class="n">get_full_name</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bereinigte Namensdaten: &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">Name: &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">Fraktion: &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">Ort: &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">Funktion &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">place</span><span class="p">,</span> <span class="n">function</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bereinigte Namensdaten: &#39;Marieluise Beck (Bremen) (BÜNDNIS 90/DIE GRÜNEN):&#39;
Name: &#39;Marieluise Beck&#39;
Fraktion: &#39;BÜNDNIS 90/DIE GRÜNEN&#39;
Ort: &#39;Bremen&#39;
Funktion &#39;Abgeordnete:r&#39;
</pre></div>
</div>
</div>
</div>
<p>Für jeden Redebeitrag sind die folgenden Schritte notwendig:</p>
<ol class="simple">
<li><p>Meta-Daten-Bereinigung</p></li>
<li><p>Extraktion einfacher Meta-Daten aus dem String</p></li>
<li><p>Politiker:innen-Matching: Vergleich extrahierter Meta-Daten mit der Politiker:innen-Übersicht</p>
<ol class="simple">
<li><p>Filterung auf Namens-Basis und ggf. hartcodierten Matches</p></li>
<li><p>Matching</p></li>
</ol>
</li>
<li><p>Ggf. Matching von Politiker:innen, die nicht in den Stammdaten sind</p></li>
<li><p>GND &amp; QID hinzufügen</p></li>
<li><p>Überprüfung ob Parteien-Match stimmt (z. B. Fehler wegen Parteiwechseln)</p></li>
</ol>
<p>Die ersten beiden Schritte werden mithilfe der obigen Funktionen durchgeführt, für den dritten Schritt werden einige einfache Filterfunktionen benötigt, die die möglichen Matches nach unterschiedlichen Kriterien filtern:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_by_period</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_period</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">periods</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filter_period</span><span class="p">),</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">filter_by_family_name</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_name</span><span class="p">):</span>
    <span class="c1"># Hier wird jeweils nur der letzte Token der beiden Namen genutzt</span>
    <span class="c1"># Bei Nachnamen wird dann nur das letzte Wort benutzt z.B. nur &quot;Guttenberg&quot; bei &quot;von Guttenberg&quot;</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">last_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">filter_name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">filter_by_full_name</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_full_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">matches</span><span class="o">.</span><span class="n">last_name</span> <span class="o">==</span> <span class="n">filter_full_name</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">filter_by_date</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_date</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[(</span><span class="n">matches</span><span class="o">.</span><span class="n">since</span> <span class="o">&lt;</span> <span class="n">filter_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">matches</span><span class="o">.</span><span class="n">until</span> <span class="o">&gt;</span> <span class="n">filter_date</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">filter_by_gender</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_gender</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">gender</span> <span class="o">==</span> <span class="n">filter_gender</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">filter_by_place</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_place</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">place</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">filter_place</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">filter_by_group</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">filter_group</span><span class="p">):</span>
    <span class="c1"># Verbesserungswürdiger Code, aber für die wenigen Edgecases ausreichend</span>
    <span class="c1"># Erkennt nur Parteien aus zusammengesetzte Fraktionsnamen (CDU/CSU) </span>
    <span class="c1"># oder identischen Fraktions-/Partei-Kombinationen (Fraktion: SPD - Partei: SPD)</span>
    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="o">.</span><span class="n">party</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">filter_group</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<p>Als letzte vorab definierte Teil-Funktion des Matching-Prozesses wird die Funktion <code class="docutils literal notranslate"><span class="pre">get_identifier()</span></code> benötigt, die die GND &amp; QID für Abgeordnete zurückgibt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_identifier</span><span class="p">(</span><span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">,</span> <span class="n">name_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">politician_identifier</span>
    <span class="k">global</span> <span class="n">manual_qid_matches</span>
    
    <span class="c1"># Matchen entweder durch die ID der*des Politiker:in oder durch den Namen</span>
    <span class="k">if</span> <span class="n">mdb_speech_id</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">politician_id_match</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">mdb_id</span> <span class="o">==</span> <span class="n">mdb_speech_id</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">manual_qid_matches</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">politician_id_match</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">qid</span> <span class="o">==</span> <span class="n">manual_qid_matches</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_data</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">politician_id_match</span> <span class="o">=</span> <span class="n">politician_identifier</span><span class="p">[</span>
                <span class="p">(</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">full_name_match</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span>
                <span class="p">((</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">mdb_id</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">|</span> <span class="p">(</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">mdb_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">|</span> 
                 <span class="p">(</span><span class="n">politician_identifier</span><span class="o">.</span><span class="n">multi_role</span> <span class="o">==</span> <span class="kc">True</span><span class="p">))]</span>

    <span class="c1"># Rückgabe eines Matches nur, wenn es einzelnes ist, sonst Error melden</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_id_match</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">GND</span> <span class="o">=</span> <span class="n">politician_id_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">gnd</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="o">~</span><span class="n">politician_id_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">gnd</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">QID</span> <span class="o">=</span> <span class="n">politician_id_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="o">~</span><span class="n">politician_id_match</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">qid</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">GND</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">QID</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;ID Error Match: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">QID</span><span class="p">,</span> <span class="n">GND</span>
</pre></div>
</div>
</div>
</div>
<p>Die bis hier definierten Funktionen werden von <code class="docutils literal notranslate"><span class="pre">get_meta_data()</span></code> aufgerufen. Diese extrahiert alle relevanten Meta-Daten, ordnet die Rede eine:r Redner:in zu und gibt all diese Informationen zurück. Dabei geht sie nach den oben genannten sechs Schritten vor und beachtet dabei zahlreiche Spezialfälle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_meta_data</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. Meta-Daten Bereinigung</span>
        <span class="n">name_data</span> <span class="o">=</span> <span class="n">clean_name_data</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>

        <span class="c1"># 2. Extrahiere einfache Meta-Daten aus dem String</span>
        <span class="n">group</span><span class="p">,</span> <span class="n">group_match</span><span class="p">,</span> <span class="n">name_data</span> <span class="o">=</span> <span class="n">get_group</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
        <span class="n">function</span><span class="p">,</span> <span class="n">function_group</span> <span class="o">=</span> <span class="n">get_function</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">get_place</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>
        <span class="n">full_name_match</span> <span class="o">=</span> <span class="n">get_full_name</span><span class="p">(</span><span class="n">name_data</span><span class="p">)</span>

        <span class="c1"># 3. Politiker:innen-Matching: Vergleiche die extrahierten Meta-Daten mit der Politiker:innen-Übersicht</span>
        <span class="c1"># 3.1 Vorfilterung auf Basis von Namen und ggf. hardcodierten Matches</span>
        <span class="c1"># Prüfe, ob es bereits vorcodierte Matches gibt</span>
        <span class="k">if</span> <span class="n">manual_matches</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">mdbs</span><span class="p">[</span><span class="n">mdbs</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">manual_matches</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_data</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))]</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="c1"># Bis zur 12 Periode wird nur der Nachname in den Protokollen vermerkt</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_period</span><span class="p">(</span><span class="n">mdbs</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_family_name</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">)</span>

            <span class="c1"># Bei Frauen wird ein &quot;Frau&quot; vorangeschoben, Männer sind &quot;default&quot;</span>
            <span class="n">gender</span> <span class="o">=</span> <span class="s2">&quot;weiblich&quot;</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[^,(.]*Frau[^,(.]*&quot;</span><span class="p">,</span> <span class="n">name_data</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;männlich&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_period</span><span class="p">(</span><span class="n">mdbs</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_full_name</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">)</span>

        <span class="c1"># 3.2 Matching</span>
        <span class="c1"># Hiermit werden direkt die weiteren Daten gesetzt, sofern der Match eine einzelne Person hervorgebracht hat</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name_match</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Falls es mehrere mögliche Matches gibt durch Namenswechsel oder gleiche Nachnamen:</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="c1"># Falls es mehrere Treffer gibt, aber die ID gleich bleibt, liegt z.B. ein Namens- oder Titelwechsel vor</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">politician_matches_temp</span> <span class="o">=</span> <span class="n">filter_by_date</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches_temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">politician_matches_temp</span>
                <span class="c1"># Falls die Stammdaten ein zu frühes &quot;until&quot; date haben und kein Match zustande kommt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

            <span class="c1"># Falls es mehrere unterschiedliche Personen Matches gibt</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">place</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_gender</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">gender</span><span class="p">)</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_place</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_gender</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">gender</span><span class="p">)</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_group</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">filter_by_place</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>

                <span class="c1"># Edgecase: Falls mehrere Personen-Matches und Namenswechsel</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">politician_matches_temp</span> <span class="o">=</span> <span class="n">filter_by_date</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches_temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">politician_matches_temp</span>
                    <span class="c1"># Falls die Stammdaten ein zu frühes &quot;until&quot; date haben und kein Match zustande kommt</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

            <span class="c1"># Match, falls nach den bisherigen Schritten eine Person gefunden wurde </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">name_match</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;name_match&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
            <span class="n">last_name</span> <span class="o">=</span> <span class="n">name_match</span><span class="o">.</span><span class="n">last_name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">name_match</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">mdb_speech_id</span> <span class="o">=</span> <span class="n">name_match</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">party</span> <span class="o">=</span> <span class="n">name_match</span><span class="o">.</span><span class="n">party</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> <span class="n">get_identifier</span><span class="p">(</span><span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">full_name_match</span><span class="p">)</span>
            <span class="n">generated_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># 4. Politiker:innen die nicht in den Stammdaten sind</span>
        <span class="c1"># Falls es bis hierhin keinen Match gibt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name_split</span> <span class="o">=</span> <span class="n">full_name_match</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_split</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="s2">&quot;von&quot;</span> <span class="ow">in</span> <span class="n">name_split</span><span class="p">:</span>
                <span class="n">last_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_split</span><span class="p">[</span><span class="n">name_split</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;von&quot;</span><span class="p">):])</span>
                <span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_split</span><span class="p">[:</span><span class="n">name_split</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;von&quot;</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_split</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">last_name</span> <span class="o">=</span> <span class="n">name_split</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;Senatorin&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name_split</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_split</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_name_match</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_split</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_name_match</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># ID für unbekannte Politiker:innen hinzufügen</span>
            <span class="n">generated_id</span><span class="p">,</span> <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">gnd</span> <span class="o">=</span> \
                <span class="n">get_unknown_politician_id</span><span class="p">(</span><span class="n">full_name_match</span><span class="p">,</span> <span class="n">name_data</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>

            <span class="c1"># Versuch via mdb_id Metainfos zu erhalten</span>
            <span class="n">politician_matches</span> <span class="o">=</span> <span class="n">mdbs</span><span class="p">[</span><span class="n">mdbs</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">mdb_speech_id</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">party</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">party</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">last_name</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">last_name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">first_name</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Todo: Verbesserung Multimatch-Handling, für Stichprobe nicht relevant, aber falls Partei einbezogen wird</span>
            <span class="c1"># Falls es mehrere Matches gab (also z.B. Namens oder Ortswechsel), nur den Vornamen und Partei übernehmen</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">politician_matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">first_name</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">party</span> <span class="o">=</span> <span class="n">politician_matches</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">party</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># 5. Überprüfung, ob der Parteien-Match stimmt (z.B. Fehler wegen Parteiwechseln)</span>
        <span class="c1"># Bei Erweiterung des Stichproben-Umfangs ggf. auch Parteiwechsel beachten</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">fractions_party_list</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">group_match</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">)):</span>
            <span class="n">possible_parties</span> <span class="o">=</span> <span class="n">fractions_party_list</span><span class="p">[</span><span class="n">fractions_party_list</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">group_match</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">)]</span><span class="o">.</span><span class="n">party</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">possible_parties</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">party</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">possible_parties</span> <span class="ow">and</span> <span class="n">group</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error in Party-Matching </span><span class="se">\n</span><span class="s2">name_data = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">party = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">group = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">period = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">date = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">name_data</span><span class="p">,</span> <span class="n">party</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

            <span class="c1"># Fraktionslose sind in der Regel Parteiausgänger, außer im Fall der Linken, diese sind bereits oben geregelt</span>
            <span class="c1"># Hierbei in jedem Fall die Logs prüfen</span>
            <span class="k">if</span> <span class="n">group</span> <span class="o">==</span> <span class="s2">&quot;fraktionslos&quot;</span> <span class="ow">or</span> <span class="n">group</span> <span class="o">==</span> <span class="s2">&quot;Fraktionslos&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name_data</span> <span class="o">==</span> <span class="s1">&#39;von Thadden (fraktionslos):&#39;</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;DRP&quot;</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">elif</span> <span class="n">group</span> <span class="o">==</span> <span class="s1">&#39;DP/FVP&#39;</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;DP&quot;</span>
            <span class="c1"># Parteiwechsler und Austritte</span>
            <span class="k">elif</span> <span class="n">name_data</span> <span class="o">==</span> <span class="s1">&#39;Martin Hohmann (CDU/CSU):&#39;</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;CDU&quot;</span>
            <span class="k">elif</span> <span class="n">name_data</span> <span class="o">==</span> <span class="s1">&#39;Dr. Müller (München) (SPD) :&#39;</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;SPD&quot;</span>
            <span class="k">elif</span> <span class="n">name_data</span> <span class="o">==</span> <span class="s1">&#39;Dr. Georg Nüßlein (CDU/CSU):&#39;</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="s2">&quot;CSU&quot;</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">party</span> <span class="o">=</span> <span class="n">group</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Party changed to </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">party</span><span class="p">))</span>

        <span class="n">meta_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">period</span><span class="p">,</span> <span class="n">protocol_number</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">party</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">function_group</span><span class="p">,</span>
              <span class="n">mdb_speech_id</span><span class="p">,</span> <span class="n">speech_name_data</span><span class="p">,</span> <span class="n">generated_id</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">qid</span><span class="p">]],</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">speech_columns</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">name_data</span><span class="p">))</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">name_data</span><span class="p">))</span>
        <span class="n">meta_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="n">speech_columns</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">meta_data</span>
</pre></div>
</div>
</div>
</div>
<p>Damit bleibt der letzte und entscheidende Schritt: Über die XML-Daten und die jeweils darin enthaltenen Redebeiträge zu iterieren, die Daten zu verarbeiten, zu annotieren und neu zu speichern:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_source</span> <span class="o">=</span> <span class="s1">&#39;../data/evaluation/annotated_protocols&#39;</span>
<span class="n">path_processed</span> <span class="o">=</span> <span class="s1">&#39;../data/evaluation/annotated_enriched_protocols&#39;</span>

<span class="n">speech_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol_number&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">,</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;function_group&quot;</span><span class="p">,</span> <span class="s2">&quot;politician_id&quot;</span><span class="p">,</span> <span class="s2">&quot;speech_name_data&quot;</span><span class="p">,</span> <span class="s2">&quot;generated_id&quot;</span><span class="p">,</span> <span class="s2">&quot;GND&quot;</span><span class="p">,</span> <span class="s2">&quot;QID&quot;</span><span class="p">]</span>
<span class="n">speeches_meta_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">speech_columns</span><span class="p">)</span>

<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path_source</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xml&#39;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_source</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

        <span class="c1"># Open XML file</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="n">sitzungsverlauf</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sitzungsverlauf&#39;</span><span class="p">)</span>

        <span class="c1"># Get meta data</span>
        <span class="n">speech_date</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sitzung-datum&quot;</span><span class="p">)</span>
        <span class="n">speech_period</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wahlperiode&quot;</span><span class="p">))</span>
        <span class="n">protocol_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sitzung-nr&quot;</span><span class="p">))</span>

        <span class="c1"># And change the data</span>
        <span class="k">for</span> <span class="n">speech</span> <span class="ow">in</span> <span class="n">sitzungsverlauf</span><span class="p">:</span>
            <span class="c1"># Identify the intro and cut off the speech</span>
            <span class="n">speech_name_data_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^.{5,150}?:&quot;</span><span class="p">,</span> <span class="n">speech</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
            <span class="n">speech_name_data</span> <span class="o">=</span> <span class="n">speech_name_data_match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">speech_name_data_match</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># Get the name meta data</span>
            <span class="n">speech_meta_data</span> <span class="o">=</span> <span class="n">get_meta_data</span><span class="p">(</span><span class="n">speech_name_data</span><span class="p">,</span> <span class="n">speech_period</span><span class="p">,</span> <span class="n">speech_date</span><span class="p">)</span>

            <span class="n">mdb_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;politician_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">else</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;politician_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;first_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;last_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;party&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;function&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;position_group&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;function_group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">mdb_id</span><span class="p">)</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;GND&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;GND&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">speech</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;QID&quot;</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">[</span><span class="s2">&quot;QID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># Add info to dataframe</span>
            <span class="n">speeches_meta_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">speeches_meta_data</span><span class="p">,</span> <span class="n">speech_meta_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">path_processed</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">file</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
        
<span class="n">speeches_meta_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../data/evaluation/speeches_meta_data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Neben den exportierten XML-Dateien wurde in dem Prozess auch die Meta-Daten-Tabelle <code class="docutils literal notranslate"><span class="pre">speeches_meta_data</span></code> erzeugt, die für Plausibilitätsprüfungen sehr sinnvoll sind. Hierfür ebenfalls nützlich ist die Log-Datei im Stammverzeichnis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speeches_meta_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>protocol_number</th>
      <th>last_name</th>
      <th>first_name</th>
      <th>group</th>
      <th>party</th>
      <th>function</th>
      <th>function_group</th>
      <th>politician_id</th>
      <th>speech_name_data</th>
      <th>generated_id</th>
      <th>GND</th>
      <th>QID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>248</td>
      <td>Lammert</td>
      <td>Norbert</td>
      <td></td>
      <td>CDU</td>
      <td>Präsident</td>
      <td>Sitzungsvorstand</td>
      <td>11001274</td>
      <td>Präsident Dr. Norbert Lammert:</td>
      <td></td>
      <td>118003674</td>
      <td>Q57474</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17</td>
      <td>248</td>
      <td>Merkel</td>
      <td>Angela</td>
      <td></td>
      <td>CDU</td>
      <td>Bundeskanzlerin</td>
      <td>Bundesregierung</td>
      <td>11001478</td>
      <td>Dr. Angela Merkel, Bundeskanzlerin:</td>
      <td></td>
      <td>119545373</td>
      <td>Q567</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17</td>
      <td>248</td>
      <td>Lammert</td>
      <td>Norbert</td>
      <td></td>
      <td>CDU</td>
      <td>Präsident</td>
      <td>Sitzungsvorstand</td>
      <td>11001274</td>
      <td>Präsident Dr. Norbert Lammert:</td>
      <td></td>
      <td>118003674</td>
      <td>Q57474</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>248</td>
      <td>Dreyer</td>
      <td>Malu</td>
      <td></td>
      <td></td>
      <td>Ministerpräsidentin (Rheinland-Pfalz)</td>
      <td>Bundesrat</td>
      <td></td>
      <td>Malu Dreyer, Ministerpräsidentin (Rheinland-Pf...</td>
      <td>1</td>
      <td>133927288</td>
      <td>Q84581</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>248</td>
      <td>Lammert</td>
      <td>Norbert</td>
      <td></td>
      <td>CDU</td>
      <td>Präsident</td>
      <td>Sitzungsvorstand</td>
      <td>11001274</td>
      <td>Präsident Dr. Norbert Lammert:</td>
      <td></td>
      <td>118003674</td>
      <td>Q57474</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7541</th>
      <td>6</td>
      <td>17</td>
      <td>Jahn</td>
      <td>Gerhard</td>
      <td></td>
      <td>SPD</td>
      <td>Bundesminister der Justiz</td>
      <td>Bundesregierung</td>
      <td>11001012</td>
      <td>Jahn, Bundesminister der Justiz:</td>
      <td></td>
      <td>12318262X</td>
      <td>Q73924</td>
    </tr>
    <tr>
      <th>7542</th>
      <td>6</td>
      <td>17</td>
      <td>Schmitt-Vockenhausen</td>
      <td>Hermann</td>
      <td></td>
      <td>SPD</td>
      <td>Vizepräsident</td>
      <td>Sitzungsvorstand</td>
      <td>11002033</td>
      <td>Vizepräsident Dr. Schmitt-Vockenhausen:</td>
      <td></td>
      <td>116810122</td>
      <td>Q1565855</td>
    </tr>
    <tr>
      <th>7543</th>
      <td>6</td>
      <td>17</td>
      <td>Weber</td>
      <td>Hubert</td>
      <td>SPD</td>
      <td>SPD</td>
      <td>Abgeordnete:r</td>
      <td>Abgeordnete:r</td>
      <td>11002436</td>
      <td>Dr. Weber (Köln) (SPD) :</td>
      <td></td>
      <td>1169058132</td>
      <td>Q1498945</td>
    </tr>
    <tr>
      <th>7544</th>
      <td>6</td>
      <td>17</td>
      <td>Jahn</td>
      <td>Gerhard</td>
      <td></td>
      <td>SPD</td>
      <td>Bundesminister der Justiz</td>
      <td>Bundesregierung</td>
      <td>11001012</td>
      <td>Jahn, Bundesminister der Justiz:</td>
      <td></td>
      <td>12318262X</td>
      <td>Q73924</td>
    </tr>
    <tr>
      <th>7545</th>
      <td>6</td>
      <td>17</td>
      <td>Schmitt-Vockenhausen</td>
      <td>Hermann</td>
      <td></td>
      <td>SPD</td>
      <td>Vizepräsident</td>
      <td>Sitzungsvorstand</td>
      <td>11002033</td>
      <td>Vizepräsident Dr. Schmitt-Vockenhausen:</td>
      <td></td>
      <td>116810122</td>
      <td>Q1565855</td>
    </tr>
  </tbody>
</table>
<p>7546 rows × 13 columns</p>
</div></div></div>
</div>
<p>Besonders wichtig für die Überprüfung ist auch die Tabelle <code class="docutils literal notranslate"><span class="pre">unknown_politician</span></code>. Damit kann überprüft werden, ob hier fälschlich unterschiedliche Politiker:innen mit dem gleichen Namen als eine Person gematched wurden, wofür die Liste der extrahierten Funktionen und der Perioden nützlich ist:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;div style=&#39;height: 500px; overflow:scroll-y&#39;&gt;&quot;</span><span class="o">+</span><span class="n">unknown_politician</span><span class="o">.</span><span class="n">to_html</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style='height: 500px; overflow:scroll-y'><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>group</th>
      <th>function</th>
      <th>periods</th>
      <th>matched_mdb_id</th>
      <th>matched_qid</th>
      <th>matched_gnd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Malu</td>
      <td>Dreyer</td>
      <td></td>
      <td>Ministerpräsidentin (Rheinland-Pfalz)</td>
      <td>[17]</td>
      <td></td>
      <td>Q84581</td>
      <td>133927288</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Stanislaw</td>
      <td>Tillich</td>
      <td></td>
      <td>Ministerpräsident (Sachsen)</td>
      <td>[17]</td>
      <td></td>
      <td>Q77391</td>
      <td>138599092</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Marcel</td>
      <td>Huber</td>
      <td></td>
      <td>Staatsminister (Bayern)</td>
      <td>[17]</td>
      <td></td>
      <td>Q1893046</td>
      <td>1066381364</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td></td>
      <td>von Manger-Koenig</td>
      <td></td>
      <td>Staatssekretär beim Bundesministerium für Jugend, Familie und Gesundheit</td>
      <td>[6]</td>
      <td></td>
      <td>Q60440254</td>
      <td>102996517X</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Heide</td>
      <td>Simonis</td>
      <td></td>
      <td>Ministerpräsidentin (Schleswig-Holstein)</td>
      <td>[14]</td>
      <td>11002178</td>
      <td>Q65515</td>
      <td>119135787</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Ursula</td>
      <td>von der Leyen</td>
      <td></td>
      <td>Ministerin (Niedersachsen)</td>
      <td>[15]</td>
      <td>11004092</td>
      <td>Q60772</td>
      <td>130338303</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>Renate</td>
      <td>Schmidt</td>
      <td></td>
      <td>Bundesministerin für Familie, Senioren, Frauen und Jugend</td>
      <td>[15]</td>
      <td>11002016</td>
      <td>Q69677</td>
      <td>119101548</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td></td>
      <td>Lauritzen</td>
      <td></td>
      <td>Bundesminister für Wohnungswesen und Städtebau</td>
      <td>[5]</td>
      <td>11001295</td>
      <td>Q71369</td>
      <td>116858966</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td></td>
      <td>Schütz</td>
      <td></td>
      <td>Staatssekretär des Auswärtigen Amts</td>
      <td>[5]</td>
      <td>11002095</td>
      <td>Q215756</td>
      <td>11905910X</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td></td>
      <td>Kiesinger</td>
      <td></td>
      <td>Bundeskanzler</td>
      <td>[5]</td>
      <td>11001096</td>
      <td>Q2512</td>
      <td>118562053</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>Reinhold</td>
      <td>Bocklet</td>
      <td></td>
      <td>Staatsminister (Bayern)</td>
      <td>[14]</td>
      <td></td>
      <td>Q104572</td>
      <td>108373592</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>Renate</td>
      <td>Künast</td>
      <td></td>
      <td>Bundesministerin für Verbraucherschutz, Ernährung und Landwirtschaft</td>
      <td>[14]</td>
      <td>11003576</td>
      <td>Q65128</td>
      <td>123681529</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>Beate</td>
      <td>Hübner</td>
      <td></td>
      <td>Senatorin (Berlin)</td>
      <td>[13]</td>
      <td></td>
      <td>Q813145</td>
      <td></td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td></td>
      <td>Vogel</td>
      <td></td>
      <td>Bundesminister der Justiz</td>
      <td>[8]</td>
      <td>11002379</td>
      <td>Q552483</td>
      <td>118627414</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td></td>
      <td>Merk</td>
      <td></td>
      <td>Staatsminister (Bayern)</td>
      <td>[8]</td>
      <td></td>
      <td>Q993550</td>
      <td>124637205</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td></td>
      <td>Hirsch</td>
      <td></td>
      <td>Minister (Nordrhein-Westfalen)</td>
      <td>[8]</td>
      <td>11000908</td>
      <td>Q107360</td>
      <td>132194058</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td></td>
      <td>Bölling</td>
      <td></td>
      <td>Staatssekretär, Chef des Presse- und Informationsamtes der Bundesregierung</td>
      <td>[8]</td>
      <td></td>
      <td>Q1744952</td>
      <td>118512692</td>
    </tr>
    <tr>
      <th>17</th>
      <td>18</td>
      <td></td>
      <td>Hartmann</td>
      <td></td>
      <td>Staatssekretär im Bundesministeriums der Finanzen</td>
      <td>[2]</td>
      <td></td>
      <td>Q2645108</td>
      <td>1025194888</td>
    </tr>
    <tr>
      <th>18</th>
      <td>19</td>
      <td></td>
      <td>Sauerborn</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für Arbeit</td>
      <td>[2]</td>
      <td></td>
      <td>Q1914072</td>
      <td>133743535</td>
    </tr>
    <tr>
      <th>19</th>
      <td>20</td>
      <td></td>
      <td>Blank</td>
      <td></td>
      <td>Bundesminister für Verteidigung</td>
      <td>[2]</td>
      <td>11000195</td>
      <td>Q65542</td>
      <td>118865528</td>
    </tr>
    <tr>
      <th>20</th>
      <td>21</td>
      <td></td>
      <td>Weber</td>
      <td></td>
      <td>Bundesminister der Justiz</td>
      <td>[4]</td>
      <td>11002437</td>
      <td>Q85846</td>
      <td>129280909</td>
    </tr>
    <tr>
      <th>21</th>
      <td>22</td>
      <td></td>
      <td>Gumbel</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium der Verteidigung</td>
      <td>[4]</td>
      <td></td>
      <td>Q15432040</td>
      <td>124419712</td>
    </tr>
    <tr>
      <th>22</th>
      <td>23</td>
      <td></td>
      <td>Ernst</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für Wohnungswesen, Städtebau und Raumordnung, Staatsekretär im Bundesministerium für Wohnungswesen, Städtebau und Raumordnung</td>
      <td>[4]</td>
      <td></td>
      <td>Q1169676</td>
      <td>118530917</td>
    </tr>
    <tr>
      <th>23</th>
      <td>24</td>
      <td></td>
      <td>Grund</td>
      <td></td>
      <td>Staatssekretär des Bundesministeriums der Finanzen</td>
      <td>[4]</td>
      <td></td>
      <td>Q2544537</td>
      <td>1029995621</td>
    </tr>
    <tr>
      <th>24</th>
      <td>25</td>
      <td></td>
      <td>Claussen</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für Arbeit und Sozialordnung</td>
      <td>[4]</td>
      <td></td>
      <td>Q1734937</td>
      <td>1023669684</td>
    </tr>
    <tr>
      <th>25</th>
      <td>26</td>
      <td></td>
      <td>Seiermann</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für Verkehr</td>
      <td>[4]</td>
      <td></td>
      <td>Q1591186</td>
      <td>103055255X</td>
    </tr>
    <tr>
      <th>26</th>
      <td>27</td>
      <td></td>
      <td>Kattenstroth</td>
      <td></td>
      <td>Staatssekretär im Bundesschatzministerium</td>
      <td>[4]</td>
      <td></td>
      <td>Q1874646</td>
      <td>1025392825</td>
    </tr>
    <tr>
      <th>27</th>
      <td>28</td>
      <td></td>
      <td>Bargatzky</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für Gesundheitswesen</td>
      <td>[4]</td>
      <td></td>
      <td>Q2543532</td>
      <td>118819143</td>
    </tr>
    <tr>
      <th>28</th>
      <td>29</td>
      <td></td>
      <td>Becker</td>
      <td></td>
      <td>Parl. Staatssekretär beim Bundesminister für das Post- und Fernmeldewesen</td>
      <td>[9]</td>
      <td>11000127</td>
      <td>Q1604393</td>
      <td>113368534</td>
    </tr>
    <tr>
      <th>29</th>
      <td>30</td>
      <td></td>
      <td>Becker</td>
      <td></td>
      <td>Staatssekretär, Chef des Presse- und Informationsamtes der Bundesregierung</td>
      <td>[9]</td>
      <td></td>
      <td>Q44212668</td>
      <td>1168145732</td>
    </tr>
    <tr>
      <th>30</th>
      <td>31</td>
      <td></td>
      <td>Lahnstein</td>
      <td></td>
      <td>Staatssekretär, Chef des Bundeskanzleramtes</td>
      <td>[9]</td>
      <td>11001269</td>
      <td>Q69133</td>
      <td>116647299</td>
    </tr>
    <tr>
      <th>31</th>
      <td>32</td>
      <td></td>
      <td>Schröder</td>
      <td></td>
      <td>Bundesminister des Innern</td>
      <td>[3]</td>
      <td>11002077</td>
      <td>Q60781</td>
      <td>118610821</td>
    </tr>
    <tr>
      <th>32</th>
      <td>33</td>
      <td></td>
      <td>Schulte</td>
      <td></td>
      <td>Parl. Staatssekretär beim Bundesminister für Verkehr</td>
      <td>[11, 10]</td>
      <td>11002100</td>
      <td>Q1222818</td>
      <td>1012385337</td>
    </tr>
    <tr>
      <th>33</th>
      <td>34</td>
      <td>Björn</td>
      <td>Engholm</td>
      <td></td>
      <td>Ministerpräsident (Schleswig-Holstein)</td>
      <td>[12]</td>
      <td>11000476</td>
      <td>Q62279</td>
      <td>118971948</td>
    </tr>
    <tr>
      <th>34</th>
      <td>35</td>
      <td>Klaus</td>
      <td>Kinkel</td>
      <td></td>
      <td>Bundesminister der Justiz</td>
      <td>[12]</td>
      <td>11002696</td>
      <td>Q159913</td>
      <td>119320762</td>
    </tr>
    <tr>
      <th>35</th>
      <td>36</td>
      <td>Reinhold</td>
      <td>Robbe</td>
      <td></td>
      <td>Wehrbeauftragter des Deutschen Bundestages</td>
      <td>[16]</td>
      <td>11002762</td>
      <td>Q2141511</td>
      <td>1111911924</td>
    </tr>
    <tr>
      <th>36</th>
      <td>37</td>
      <td></td>
      <td>von Hase</td>
      <td></td>
      <td>Staatssekretär des Bundesministeriums der Verteidigung, Staatssekretär des Bundesministeriums für Verteidigung</td>
      <td>[5]</td>
      <td></td>
      <td>Q1729788</td>
      <td>118829270</td>
    </tr>
    <tr>
      <th>37</th>
      <td>38</td>
      <td></td>
      <td>Töpfer</td>
      <td></td>
      <td>Bundesminister für Umwelt, Naturschutz und Reaktorsicherheit</td>
      <td>[11]</td>
      <td>11002335</td>
      <td>Q62889</td>
      <td>118842455</td>
    </tr>
    <tr>
      <th>38</th>
      <td>39</td>
      <td></td>
      <td>Wimmer</td>
      <td></td>
      <td>Parl. Staatssekretär beim Bundesminister der Verteidigung</td>
      <td>[11]</td>
      <td>11002524</td>
      <td>Q2582265</td>
      <td>122602803</td>
    </tr>
    <tr>
      <th>39</th>
      <td>40</td>
      <td></td>
      <td>Schäfer</td>
      <td></td>
      <td>Staatsminister beim Bundesminister des Auswärtigen</td>
      <td>[11]</td>
      <td>11001932</td>
      <td>Q1604190</td>
      <td>170226085</td>
    </tr>
    <tr>
      <th>40</th>
      <td>41</td>
      <td></td>
      <td>Bangemann</td>
      <td></td>
      <td>Bundesminister für Wirtschaft</td>
      <td>[10]</td>
      <td>11000089</td>
      <td>Q61250</td>
      <td>120084287</td>
    </tr>
    <tr>
      <th>41</th>
      <td>42</td>
      <td></td>
      <td>Süssmuth</td>
      <td></td>
      <td>Bundesminister für Jugend, Familie und Gesundheit</td>
      <td>[10]</td>
      <td>11002287</td>
      <td>Q66286</td>
      <td>118992872</td>
    </tr>
    <tr>
      <th>42</th>
      <td>43</td>
      <td></td>
      <td>Schreckenberger</td>
      <td></td>
      <td>Staatssekretär, Chef des Bundeskanzleramtes</td>
      <td>[10]</td>
      <td></td>
      <td>Q97644</td>
      <td>129373877</td>
    </tr>
    <tr>
      <th>43</th>
      <td>44</td>
      <td></td>
      <td>Vogt</td>
      <td></td>
      <td>Parl. Staatssekretär beim Bundesminister für Arbeit und Sozialordnung</td>
      <td>[10]</td>
      <td>11002384</td>
      <td>Q2591659</td>
      <td>131370774</td>
    </tr>
    <tr>
      <th>44</th>
      <td>45</td>
      <td></td>
      <td>Hopf</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium der Verteidigung</td>
      <td>[4]</td>
      <td></td>
      <td>Q2531479</td>
      <td>124376932</td>
    </tr>
    <tr>
      <th>45</th>
      <td>46</td>
      <td></td>
      <td>Herz</td>
      <td></td>
      <td>Staatssekretär im Bundesministerium für das Post- und Fernmeldewesen</td>
      <td>[4]</td>
      <td></td>
      <td>Q1731618</td>
      <td>1024211339</td>
    </tr>
    <tr>
      <th>46</th>
      <td>47</td>
      <td></td>
      <td>Lücke</td>
      <td></td>
      <td>Bundesminister für Wohnungswesen, Städtebau und Raumordnung</td>
      <td>[4]</td>
      <td>11001387</td>
      <td>Q69098</td>
      <td>118729519</td>
    </tr>
    <tr>
      <th>47</th>
      <td>48</td>
      <td></td>
      <td>Franke</td>
      <td></td>
      <td>Bundesminister für innerdeutsche Beziehungen</td>
      <td>[7]</td>
      <td>11000570</td>
      <td>Q486035</td>
      <td>118692747</td>
    </tr>
    <tr>
      <th>48</th>
      <td>49</td>
      <td></td>
      <td>Stoltenberg</td>
      <td></td>
      <td>Bundesminister der Finanzen</td>
      <td>[9]</td>
      <td>11002259</td>
      <td>Q62214</td>
      <td>118618601</td>
    </tr>
  </tbody>
</table></div></div></div>
</div>
<hr class="docutils" />
<p><a id="ref_1"></a>[1] Zu Inter-Annotator-Bewertung: Lars Wissler, Mohammed Almashraee, Dagmar Monett, u. a., The Gold Standard in Corpus Annotation, in: Proceedings of the 5th IEEE Germany Students Conference 2014, ResearchGate 2014, <a class="reference external" href="https://doi.org/10.13140/2.1.4316.3523">https://doi.org/10.13140/2.1.4316.3523</a>, S. 3.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="3_methode.html" title="zurück Seite">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">zurück</p>
            <p class="prev-next-title">3 Methode: Goldstandard-Korpus-Evaluation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3-4_matching.html" title="weiter Seite">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">weiter</p>
        <p class="prev-next-title">3.4 Matching der Redebeiträge</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Paul Ramisch<br/>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>